A conda environment has been detected CONDA_PREFIX=
/u/langzhou/.conda/envs/medfuse 
anaconda3_cpu is loaded. Consider running conda deactivate and reloading it.
cur args is:  Namespace(align=0.0, batch_size=16, beta_1=0.9, crop=224, cxr_data_dir='physionet.org/files/mimic-cxr-jpg/2.0.0', daft_activation='linear', data_pairs='paired_ehr_cxr', data_ratio=1.0, depth=1, dim=256, dropout=0.3, ehr_data_dir='mimic4extract/data', epochs=50, eval=False, fusion='joint', fusion_type='early', imputation='previous', labels_set='pheno', layer_after=4, layers=2, load_state=None, load_state_cxr=None, load_state_ehr=None, lr=3.833e-05, missing_token=None, mmtm_ratio=4, mode='train', network=None, normalizer_state=None, num_classes=25, patience=15, pretrained=False, rec_dropout=0.0, resize=256, resume=False, save_dir='checkpoints/phenotyping/early', task='phenotyping', timestep=1.0, vision_backbone='resnet34', vision_num_classes=25)
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
  layer_after                             : 4
  layers                                  : 2
  vision_num_classes                      : 25
  resize                                  : 256
  crop                                    : 224
  vision_backbone                         : resnet34
  pretrained                              : False
  eval                                    : False
  network                                 : None
  fusion_type                             : early
  task                                    : phenotyping
  labels_set                              : pheno
  data_ratio                              : 1.0
  mmtm_ratio                              : 4
  daft_activation                         : linear
  fusion                                  : joint
  dim                                     : 256
  depth                                   : 1
  epochs                                  : 50
  load_state                              : None
  load_state_cxr                          : None
  load_state_ehr                          : None
  mode                                    : train
  batch_size                              : 16
  resume                                  : False
  dropout                                 : 0.3
  num_classes                             : 25
  patience                                : 15
  rec_dropout                             : 0.0
  timestep                                : 1.0
  imputation                              : previous
  lr                                      : 3.833e-05
  align                                   : 0.0
  data_pairs                              : paired_ehr_cxr
  missing_token                           : None
  beta_1                                  : 0.9
  normalizer_state                        : None
  ehr_data_dir                            : mimic4extract/data
  cxr_data_dir                            : physionet.org/files/mimic-cxr-jpg/2.0.0
  save_dir                                : checkpoints/phenotyping/early
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/nn/modules/rnn.py:65: UserWarning: dropout option adds dropout after all but last recurrent layer, so non-zero dropout expects num_layers greater than 1, but got dropout=0.3 and num_layers=1
  "num_layers={}".format(dropout, num_layers))
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='mean' instead.
  warnings.warn(warning.format(ret))
LSTM(
  (layer0): LSTM(76, 256, batch_first=True, dropout=0.3)
  (layer1): LSTM(256, 256, batch_first=True, dropout=0.3)
  (do): Dropout(p=0.3, inplace=False)
  (dense_layer): Linear(in_features=256, out_features=25, bias=True)
)
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.9)
    eps: 1e-08
    lr: 3.833e-05
    weight_decay: 0
)
BCELoss()
==> training
running for fusion_type early
starting val epoch 1
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /opt/conda/conda-bld/pytorch_1623448272031/work/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
val [0001 / 0050] validation loss: 	2.95139 	0.00000
saving last checkpoint at epoch 1
saving best checkpoint at epoch 1
Acute and unspecified renal failure                                                        & 0.512(0.553, 0.469) & 0.341 (0.391, 0.300) 
Acute cerebrovascular disease                                                              & 0.556(0.632, 0.483) & 0.081 (0.130, 0.058) 
Acute myocardial infarction                                                                & 0.501(0.575, 0.433) & 0.093 (0.141, 0.069) 
Cardiac dysrhythmias                                                                       & 0.489(0.531, 0.451) & 0.349 (0.402, 0.307) 
Chronic kidney disease                                                                     & 0.525(0.571, 0.480) & 0.247 (0.295, 0.213) 
Chronic obstructive pulmonary disease and bronchiectasis                                   & 0.482(0.532, 0.433) & 0.178 (0.218, 0.149) 
Complications of surgical procedures or medical care                                       & 0.498(0.545, 0.451) & 0.221 (0.272, 0.184) 
Conduction disorders                                                                       & 0.465(0.521, 0.407) & 0.113 (0.153, 0.091) 
Congestive heart failure; nonhypertensive                                                  & 0.460(0.504, 0.422) & 0.288 (0.333, 0.253) 
Coronary atherosclerosis and other heart disease                                           & 0.485(0.526, 0.446) & 0.328 (0.378, 0.290) 
Diabetes mellitus with complications                                                       & 0.577(0.634, 0.517) & 0.170 (0.237, 0.131) 
Diabetes mellitus without complication                                                     & 0.547(0.594, 0.504) & 0.237 (0.293, 0.201) 
Disorders of lipid metabolism                                                              & 0.485(0.522, 0.445) & 0.445 (0.495, 0.402) 
Essential hypertension                                                                     & 0.511(0.551, 0.470) & 0.446 (0.498, 0.400) 
Fluid and electrolyte disorders                                                            & 0.539(0.579, 0.503) & 0.464 (0.515, 0.419) 
Gastrointestinal hemorrhage                                                                & 0.506(0.579, 0.436) & 0.072 (0.129, 0.050) 
Hypertension with complications and secondary hypertension                                 & 0.528(0.575, 0.482) & 0.224 (0.276, 0.190) 
Other liver diseases                                                                       & 0.439(0.493, 0.385) & 0.127 (0.165, 0.103) 
Other lower respiratory disease                                                            & 0.496(0.555, 0.439) & 0.128 (0.168, 0.103) 
Other upper respiratory disease                                                            & 0.475(0.541, 0.408) & 0.083 (0.116, 0.064) 
Pleurisy; pneumothorax; pulmonary collapse                                                 & 0.474(0.541, 0.412) & 0.138 (0.199, 0.101) 
Pneumonia (except that caused by tuberculosis or sexually transmitted disease)             & 0.465(0.516, 0.418) & 0.200 (0.255, 0.165) 
Respiratory failure; insufficiency; arrest (adult)                                         & 0.505(0.544, 0.464) & 0.314 (0.355, 0.275) 
Septicemia (except in labor)                                                               & 0.500(0.545, 0.458) & 0.210 (0.251, 0.177) 
Shock                                                                                      & 0.490(0.532, 0.442) & 0.208 (0.256, 0.171) 



val  1   best mean auc :0.500 mean auprc 0.228 


                    CI AUROC (0.450, 0.552) CI AUPRC (0.195, 0.277) 


                     AUROC accute 0.501 mixed 0.486 chronic 0.509


                     AUROC accute CI (0.448, 0.557) mixed (0.436 , 0.537) chronic (0.466, 0.553)


                     AUPRC accute  0.196 mixed 0.209 chronic 0.301 


                     AUPRC accute CI  (0.164, 0.244) mixed (0.177,  0.258) chronic (0.264, 0.350) 


                    
starting train epoch 1
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0001 / 0050] [0009/484] eta: 6 Days 2:47:53        lr: 	3.8330E-05 loss: 	0.72845 loss align 0.0000
 epoch [0001 / 0050] [0109/484] eta: 1 Days 0:46:39        lr: 	3.8330E-05 loss: 	0.53184 loss align 0.0000
 epoch [0001 / 0050] [0209/484] eta: 0 Days 18:55:34       lr: 	3.8330E-05 loss: 	0.51091 loss align 0.0000
 epoch [0001 / 0050] [0309/484] eta: 0 Days 16:48:39       lr: 	3.8330E-05 loss: 	0.50419 loss align 0.0000
 epoch [0001 / 0050] [0409/484] eta: 0 Days 15:41:38       lr: 	3.8330E-05 loss: 	0.49957 loss align 0.0000
starting val epoch 2
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0002 / 0050] validation loss: 	0.49882 	0.00000
saving last checkpoint at epoch 2
saving best checkpoint at epoch 2
Acute and unspecified renal failure                                                        & 0.528(0.567, 0.489) & 0.349 (0.399, 0.309) 
Acute cerebrovascular disease                                                              & 0.496(0.586, 0.408) & 0.074 (0.112, 0.051) 
Acute myocardial infarction                                                                & 0.522(0.586, 0.457) & 0.091 (0.122, 0.070) 
Cardiac dysrhythmias                                                                       & 0.517(0.553, 0.473) & 0.363 (0.416, 0.321) 
Chronic kidney disease                                                                     & 0.561(0.601, 0.518) & 0.273 (0.324, 0.230) 
Chronic obstructive pulmonary disease and bronchiectasis                                   & 0.467(0.516, 0.417) & 0.178 (0.219, 0.151) 
Complications of surgical procedures or medical care                                       & 0.533(0.581, 0.486) & 0.243 (0.302, 0.205) 
Conduction disorders                                                                       & 0.551(0.608, 0.495) & 0.129 (0.168, 0.104) 
Congestive heart failure; nonhypertensive                                                  & 0.570(0.612, 0.531) & 0.379 (0.436, 0.329) 
Coronary atherosclerosis and other heart disease                                           & 0.513(0.556, 0.474) & 0.341 (0.392, 0.300) 
Diabetes mellitus with complications                                                       & 0.532(0.587, 0.477) & 0.143 (0.187, 0.114) 
Diabetes mellitus without complication                                                     & 0.505(0.551, 0.458) & 0.207 (0.253, 0.171) 
Disorders of lipid metabolism                                                              & 0.512(0.551, 0.475) & 0.462 (0.510, 0.419) 
Essential hypertension                                                                     & 0.476(0.517, 0.437) & 0.429 (0.482, 0.388) 
Fluid and electrolyte disorders                                                            & 0.525(0.565, 0.488) & 0.456 (0.511, 0.406) 
Gastrointestinal hemorrhage                                                                & 0.496(0.564, 0.421) & 0.068 (0.108, 0.049) 
Hypertension with complications and secondary hypertension                                 & 0.516(0.560, 0.472) & 0.219 (0.266, 0.185) 
Other liver diseases                                                                       & 0.559(0.612, 0.506) & 0.190 (0.256, 0.147) 
Other lower respiratory disease                                                            & 0.467(0.524, 0.413) & 0.116 (0.148, 0.094) 
Other upper respiratory disease                                                            & 0.491(0.561, 0.431) & 0.086 (0.119, 0.067) 
Pleurisy; pneumothorax; pulmonary collapse                                                 & 0.530(0.591, 0.467) & 0.130 (0.172, 0.100) 
Pneumonia (except that caused by tuberculosis or sexually transmitted disease)             & 0.549(0.599, 0.501) & 0.240 (0.300, 0.198) 
Respiratory failure; insufficiency; arrest (adult)                                         & 0.517(0.560, 0.474) & 0.343 (0.395, 0.298) 
Septicemia (except in labor)                                                               & 0.494(0.539, 0.448) & 0.213 (0.255, 0.180) 
Shock                                                                                      & 0.566(0.613, 0.518) & 0.241 (0.302, 0.199) 



val  2   best mean auc :0.520 mean auprc 0.239 


                    CI AUROC (0.469, 0.570) CI AUPRC (0.203, 0.286) 


                     AUROC accute 0.516 mixed 0.546 chronic 0.507


                     AUROC accute CI (0.462, 0.572) mixed (0.496 , 0.594) chronic (0.464, 0.550)


                     AUPRC accute  0.204 mixed 0.241 chronic 0.301 


                     AUPRC accute CI  (0.171, 0.250) mixed (0.203,  0.293) chronic (0.263, 0.349) 


                    
starting train epoch 2
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0002 / 0050] [0009/484] eta: 0 Days 19:5:28        lr: 	3.8330E-05 loss: 	0.54849 loss align 0.0000
 epoch [0002 / 0050] [0109/484] eta: 0 Days 17:52:44       lr: 	3.8330E-05 loss: 	0.48906 loss align 0.0000
 epoch [0002 / 0050] [0209/484] eta: 0 Days 17:0:18        lr: 	3.8330E-05 loss: 	0.48575 loss align 0.0000
 epoch [0002 / 0050] [0309/484] eta: 0 Days 16:20:7        lr: 	3.8330E-05 loss: 	0.48590 loss align 0.0000
 epoch [0002 / 0050] [0409/484] eta: 0 Days 15:48:40       lr: 	3.8330E-05 loss: 	0.48708 loss align 0.0000
starting val epoch 3
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0003 / 0050] validation loss: 	0.49797 	0.00000
saving last checkpoint at epoch 3
saving best checkpoint at epoch 3
Acute and unspecified renal failure                                                        & 0.558(0.595, 0.517) & 0.375 (0.433, 0.330) 
Acute cerebrovascular disease                                                              & 0.503(0.594, 0.412) & 0.079 (0.127, 0.054) 
Acute myocardial infarction                                                                & 0.519(0.580, 0.456) & 0.088 (0.116, 0.067) 
Cardiac dysrhythmias                                                                       & 0.520(0.558, 0.480) & 0.369 (0.422, 0.324) 
Chronic kidney disease                                                                     & 0.541(0.583, 0.493) & 0.274 (0.330, 0.227) 
Chronic obstructive pulmonary disease and bronchiectasis                                   & 0.522(0.571, 0.471) & 0.226 (0.281, 0.183) 
Complications of surgical procedures or medical care                                       & 0.525(0.572, 0.482) & 0.243 (0.300, 0.206) 
Conduction disorders                                                                       & 0.537(0.596, 0.479) & 0.136 (0.181, 0.106) 
Congestive heart failure; nonhypertensive                                                  & 0.577(0.620, 0.539) & 0.384 (0.442, 0.342) 
Coronary atherosclerosis and other heart disease                                           & 0.505(0.540, 0.462) & 0.330 (0.379, 0.290) 
Diabetes mellitus with complications                                                       & 0.524(0.576, 0.470) & 0.139 (0.183, 0.111) 
Diabetes mellitus without complication                                                     & 0.514(0.561, 0.467) & 0.210 (0.258, 0.177) 
Disorders of lipid metabolism                                                              & 0.516(0.552, 0.477) & 0.465 (0.517, 0.425) 
Essential hypertension                                                                     & 0.468(0.505, 0.429) & 0.428 (0.477, 0.384) 
Fluid and electrolyte disorders                                                            & 0.544(0.581, 0.504) & 0.459 (0.511, 0.414) 
Gastrointestinal hemorrhage                                                                & 0.490(0.559, 0.420) & 0.064 (0.095, 0.048) 
Hypertension with complications and secondary hypertension                                 & 0.463(0.508, 0.415) & 0.204 (0.245, 0.169) 
Other liver diseases                                                                       & 0.567(0.620, 0.516) & 0.199 (0.265, 0.152) 
Other lower respiratory disease                                                            & 0.466(0.522, 0.411) & 0.118 (0.153, 0.097) 
Other upper respiratory disease                                                            & 0.505(0.575, 0.435) & 0.092 (0.127, 0.070) 
Pleurisy; pneumothorax; pulmonary collapse                                                 & 0.538(0.602, 0.470) & 0.137 (0.184, 0.106) 
Pneumonia (except that caused by tuberculosis or sexually transmitted disease)             & 0.551(0.599, 0.501) & 0.243 (0.304, 0.200) 
Respiratory failure; insufficiency; arrest (adult)                                         & 0.558(0.600, 0.518) & 0.369 (0.427, 0.320) 
Septicemia (except in labor)                                                               & 0.523(0.566, 0.478) & 0.224 (0.269, 0.194) 
Shock                                                                                      & 0.576(0.622, 0.528) & 0.250 (0.308, 0.206) 



val  3   best mean auc :0.524 mean auprc 0.244 


                    CI AUROC (0.473, 0.574) CI AUPRC (0.208, 0.293) 


                     AUROC accute 0.527 mixed 0.545 chronic 0.504


                     AUROC accute CI (0.472, 0.582) mixed (0.497 , 0.594) chronic (0.459, 0.546)


                     AUPRC accute  0.211 mixed 0.245 chronic 0.305 


                     AUPRC accute CI  (0.178, 0.258) mixed (0.207,  0.299) chronic (0.265, 0.355) 


                    
starting train epoch 3
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0003 / 0050] [0009/484] eta: 0 Days 17:25:5        lr: 	3.8330E-05 loss: 	0.53685 loss align 0.0000
 epoch [0003 / 0050] [0109/484] eta: 0 Days 16:51:15       lr: 	3.8330E-05 loss: 	0.48731 loss align 0.0000
 epoch [0003 / 0050] [0209/484] eta: 0 Days 16:22:22       lr: 	3.8330E-05 loss: 	0.48549 loss align 0.0000
 epoch [0003 / 0050] [0309/484] eta: 0 Days 15:57:39       lr: 	3.8330E-05 loss: 	0.48765 loss align 0.0000
 epoch [0003 / 0050] [0409/484] eta: 0 Days 15:36:7        lr: 	3.8330E-05 loss: 	0.48658 loss align 0.0000
starting val epoch 4
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0004 / 0050] validation loss: 	0.49745 	0.00000
saving last checkpoint at epoch 4
saving best checkpoint at epoch 4
Acute and unspecified renal failure                                                        & 0.563(0.602, 0.518) & 0.388 (0.444, 0.340) 
Acute cerebrovascular disease                                                              & 0.524(0.614, 0.433) & 0.099 (0.162, 0.062) 
Acute myocardial infarction                                                                & 0.470(0.533, 0.411) & 0.080 (0.113, 0.062) 
Cardiac dysrhythmias                                                                       & 0.527(0.564, 0.486) & 0.371 (0.423, 0.324) 
Chronic kidney disease                                                                     & 0.516(0.559, 0.470) & 0.265 (0.319, 0.218) 
Chronic obstructive pulmonary disease and bronchiectasis                                   & 0.544(0.594, 0.494) & 0.230 (0.283, 0.184) 
Complications of surgical procedures or medical care                                       & 0.520(0.566, 0.474) & 0.229 (0.277, 0.196) 
Conduction disorders                                                                       & 0.544(0.609, 0.482) & 0.143 (0.190, 0.111) 
Congestive heart failure; nonhypertensive                                                  & 0.590(0.630, 0.548) & 0.393 (0.455, 0.345) 
Coronary atherosclerosis and other heart disease                                           & 0.504(0.544, 0.464) & 0.335 (0.384, 0.295) 
Diabetes mellitus with complications                                                       & 0.503(0.558, 0.445) & 0.126 (0.164, 0.102) 
Diabetes mellitus without complication                                                     & 0.492(0.541, 0.448) & 0.197 (0.237, 0.166) 
Disorders of lipid metabolism                                                              & 0.520(0.556, 0.483) & 0.468 (0.513, 0.425) 
Essential hypertension                                                                     & 0.479(0.514, 0.436) & 0.431 (0.479, 0.388) 
Fluid and electrolyte disorders                                                            & 0.550(0.589, 0.512) & 0.476 (0.527, 0.428) 
Gastrointestinal hemorrhage                                                                & 0.472(0.546, 0.401) & 0.066 (0.114, 0.047) 
Hypertension with complications and secondary hypertension                                 & 0.463(0.510, 0.417) & 0.203 (0.253, 0.173) 
Other liver diseases                                                                       & 0.570(0.625, 0.520) & 0.186 (0.252, 0.147) 
Other lower respiratory disease                                                            & 0.494(0.549, 0.439) & 0.125 (0.161, 0.102) 
Other upper respiratory disease                                                            & 0.506(0.575, 0.438) & 0.096 (0.138, 0.071) 
Pleurisy; pneumothorax; pulmonary collapse                                                 & 0.527(0.591, 0.464) & 0.130 (0.175, 0.102) 
Pneumonia (except that caused by tuberculosis or sexually transmitted disease)             & 0.569(0.617, 0.522) & 0.270 (0.334, 0.216) 
Respiratory failure; insufficiency; arrest (adult)                                         & 0.598(0.639, 0.557) & 0.396 (0.455, 0.348) 
Septicemia (except in labor)                                                               & 0.535(0.579, 0.489) & 0.233 (0.281, 0.198) 
Shock                                                                                      & 0.599(0.645, 0.549) & 0.275 (0.336, 0.223) 



val  4   best mean auc :0.527 mean auprc 0.248 


                    CI AUROC (0.476, 0.578) CI AUPRC (0.211, 0.299) 


                     AUROC accute 0.533 mixed 0.547 chronic 0.503


                     AUROC accute CI (0.477, 0.588) mixed (0.496 , 0.597) chronic (0.459, 0.546)


                     AUPRC accute  0.220 mixed 0.244 chronic 0.304 


                     AUPRC accute CI  (0.184, 0.271) mixed (0.206,  0.297) chronic (0.264, 0.352) 


                    
starting train epoch 4
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0004 / 0050] [0009/484] eta: 0 Days 16:37:49       lr: 	3.8330E-05 loss: 	0.51431 loss align 0.0000
 epoch [0004 / 0050] [0109/484] eta: 0 Days 16:15:16       lr: 	3.8330E-05 loss: 	0.48494 loss align 0.0000
 epoch [0004 / 0050] [0209/484] eta: 0 Days 15:55:1        lr: 	3.8330E-05 loss: 	0.48241 loss align 0.0000
 epoch [0004 / 0050] [0309/484] eta: 0 Days 15:36:45       lr: 	3.8330E-05 loss: 	0.48444 loss align 0.0000
 epoch [0004 / 0050] [0409/484] eta: 0 Days 15:19:41       lr: 	3.8330E-05 loss: 	0.48495 loss align 0.0000
starting val epoch 5
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0005 / 0050] validation loss: 	0.49798 	0.00000
saving last checkpoint at epoch 5
saving best checkpoint at epoch 5
Acute and unspecified renal failure                                                        & 0.542(0.582, 0.499) & 0.364 (0.416, 0.322) 
Acute cerebrovascular disease                                                              & 0.575(0.657, 0.491) & 0.109 (0.176, 0.071) 
Acute myocardial infarction                                                                & 0.484(0.548, 0.423) & 0.082 (0.109, 0.064) 
Cardiac dysrhythmias                                                                       & 0.523(0.566, 0.483) & 0.370 (0.423, 0.327) 
Chronic kidney disease                                                                     & 0.534(0.580, 0.488) & 0.270 (0.324, 0.226) 
Chronic obstructive pulmonary disease and bronchiectasis                                   & 0.548(0.597, 0.492) & 0.232 (0.287, 0.188) 
Complications of surgical procedures or medical care                                       & 0.523(0.576, 0.480) & 0.232 (0.282, 0.198) 
Conduction disorders                                                                       & 0.529(0.591, 0.468) & 0.134 (0.181, 0.108) 
Congestive heart failure; nonhypertensive                                                  & 0.593(0.636, 0.552) & 0.398 (0.459, 0.349) 
Coronary atherosclerosis and other heart disease                                           & 0.509(0.552, 0.468) & 0.337 (0.387, 0.296) 
Diabetes mellitus with complications                                                       & 0.514(0.566, 0.453) & 0.129 (0.169, 0.103) 
Diabetes mellitus without complication                                                     & 0.501(0.547, 0.452) & 0.202 (0.245, 0.170) 
Disorders of lipid metabolism                                                              & 0.525(0.563, 0.487) & 0.471 (0.522, 0.430) 
Essential hypertension                                                                     & 0.478(0.515, 0.436) & 0.428 (0.478, 0.387) 
Fluid and electrolyte disorders                                                            & 0.548(0.584, 0.511) & 0.457 (0.506, 0.414) 
Gastrointestinal hemorrhage                                                                & 0.472(0.543, 0.392) & 0.064 (0.107, 0.045) 
Hypertension with complications and secondary hypertension                                 & 0.468(0.514, 0.420) & 0.209 (0.259, 0.175) 
Other liver diseases                                                                       & 0.580(0.631, 0.528) & 0.181 (0.236, 0.146) 
Other lower respiratory disease                                                            & 0.511(0.566, 0.453) & 0.132 (0.172, 0.105) 
Other upper respiratory disease                                                            & 0.535(0.601, 0.466) & 0.100 (0.141, 0.075) 
Pleurisy; pneumothorax; pulmonary collapse                                                 & 0.523(0.586, 0.463) & 0.127 (0.176, 0.099) 
Pneumonia (except that caused by tuberculosis or sexually transmitted disease)             & 0.580(0.627, 0.534) & 0.250 (0.314, 0.204) 
Respiratory failure; insufficiency; arrest (adult)                                         & 0.628(0.670, 0.591) & 0.414 (0.474, 0.364) 
Septicemia (except in labor)                                                               & 0.527(0.568, 0.479) & 0.223 (0.264, 0.191) 
Shock                                                                                      & 0.618(0.661, 0.568) & 0.287 (0.353, 0.233) 



val  5   best mean auc :0.535 mean auprc 0.248 


                    CI AUROC (0.483, 0.585) CI AUPRC (0.212, 0.298) 


                     AUROC accute 0.543 mixed 0.548 chronic 0.509


                     AUROC accute CI (0.488, 0.598) mixed (0.497 , 0.598) chronic (0.463, 0.553)


                     AUPRC accute  0.219 mixed 0.242 chronic 0.307 


                     AUPRC accute CI  (0.184, 0.268) mixed (0.206,  0.294) chronic (0.267, 0.357) 


                    
starting train epoch 5
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0005 / 0050] [0009/484] eta: 0 Days 16:3:50        lr: 	3.8330E-05 loss: 	0.52049 loss align 0.0000
 epoch [0005 / 0050] [0109/484] eta: 0 Days 15:46:27       lr: 	3.8330E-05 loss: 	0.48765 loss align 0.0000
 epoch [0005 / 0050] [0209/484] eta: 0 Days 15:30:24       lr: 	3.8330E-05 loss: 	0.48752 loss align 0.0000
 epoch [0005 / 0050] [0309/484] eta: 0 Days 15:15:13       lr: 	3.8330E-05 loss: 	0.48560 loss align 0.0000
 epoch [0005 / 0050] [0409/484] eta: 0 Days 15:0:55        lr: 	3.8330E-05 loss: 	0.48539 loss align 0.0000
starting val epoch 6
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0006 / 0050] validation loss: 	0.49710 	0.00000
saving last checkpoint at epoch 6
saving best checkpoint at epoch 6
Acute and unspecified renal failure                                                        & 0.558(0.598, 0.516) & 0.388 (0.443, 0.344) 
Acute cerebrovascular disease                                                              & 0.605(0.690, 0.519) & 0.115 (0.192, 0.077) 
Acute myocardial infarction                                                                & 0.476(0.541, 0.414) & 0.081 (0.109, 0.063) 
Cardiac dysrhythmias                                                                       & 0.531(0.572, 0.491) & 0.375 (0.427, 0.330) 
Chronic kidney disease                                                                     & 0.546(0.588, 0.501) & 0.275 (0.329, 0.233) 
Chronic obstructive pulmonary disease and bronchiectasis                                   & 0.562(0.614, 0.512) & 0.239 (0.300, 0.194) 
Complications of surgical procedures or medical care                                       & 0.513(0.562, 0.464) & 0.225 (0.274, 0.187) 
Conduction disorders                                                                       & 0.545(0.603, 0.486) & 0.133 (0.179, 0.106) 
Congestive heart failure; nonhypertensive                                                  & 0.597(0.636, 0.556) & 0.406 (0.464, 0.354) 
Coronary atherosclerosis and other heart disease                                           & 0.515(0.555, 0.474) & 0.344 (0.396, 0.305) 
Diabetes mellitus with complications                                                       & 0.512(0.568, 0.451) & 0.126 (0.163, 0.102) 
Diabetes mellitus without complication                                                     & 0.512(0.563, 0.467) & 0.206 (0.248, 0.177) 
Disorders of lipid metabolism                                                              & 0.518(0.555, 0.475) & 0.474 (0.521, 0.425) 
Essential hypertension                                                                     & 0.493(0.531, 0.455) & 0.440 (0.492, 0.393) 
Fluid and electrolyte disorders                                                            & 0.551(0.588, 0.513) & 0.482 (0.532, 0.434) 
Gastrointestinal hemorrhage                                                                & 0.479(0.553, 0.406) & 0.066 (0.099, 0.049) 
Hypertension with complications and secondary hypertension                                 & 0.486(0.532, 0.440) & 0.219 (0.270, 0.185) 
Other liver diseases                                                                       & 0.572(0.633, 0.520) & 0.185 (0.248, 0.146) 
Other lower respiratory disease                                                            & 0.519(0.573, 0.460) & 0.139 (0.182, 0.111) 
Other upper respiratory disease                                                            & 0.542(0.610, 0.476) & 0.099 (0.139, 0.075) 
Pleurisy; pneumothorax; pulmonary collapse                                                 & 0.514(0.575, 0.453) & 0.124 (0.170, 0.097) 
Pneumonia (except that caused by tuberculosis or sexually transmitted disease)             & 0.595(0.644, 0.544) & 0.284 (0.350, 0.232) 
Respiratory failure; insufficiency; arrest (adult)                                         & 0.639(0.676, 0.598) & 0.430 (0.484, 0.380) 
Septicemia (except in labor)                                                               & 0.540(0.585, 0.494) & 0.232 (0.276, 0.200) 
Shock                                                                                      & 0.637(0.688, 0.590) & 0.310 (0.380, 0.254) 



val  6   best mean auc :0.542 mean auprc 0.256 


                    CI AUROC (0.491, 0.593) CI AUPRC (0.218, 0.307) 


                     AUROC accute 0.551 mixed 0.552 chronic 0.519


                     AUROC accute CI (0.496, 0.607) mixed (0.501 , 0.602) chronic (0.475, 0.563)


                     AUPRC accute  0.229 mixed 0.245 chronic 0.314 


                     AUPRC accute CI  (0.193, 0.279) mixed (0.208,  0.296) chronic (0.273, 0.365) 


                    
starting train epoch 6
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0006 / 0050] [0009/484] eta: 0 Days 15:34:27       lr: 	3.8330E-05 loss: 	0.53512 loss align 0.0000
 epoch [0006 / 0050] [0109/484] eta: 0 Days 15:20:8        lr: 	3.8330E-05 loss: 	0.48842 loss align 0.0000
 epoch [0006 / 0050] [0209/484] eta: 0 Days 15:6:44        lr: 	3.8330E-05 loss: 	0.48719 loss align 0.0000
 epoch [0006 / 0050] [0309/484] eta: 0 Days 14:53:47       lr: 	3.8330E-05 loss: 	0.48575 loss align 0.0000
 epoch [0006 / 0050] [0409/484] eta: 0 Days 14:41:40       lr: 	3.8330E-05 loss: 	0.48526 loss align 0.0000
starting val epoch 7
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0007 / 0050] validation loss: 	0.49728 	0.00000
saving last checkpoint at epoch 7
saving best checkpoint at epoch 7
Acute and unspecified renal failure                                                        & 0.579(0.617, 0.539) & 0.420 (0.483, 0.368) 
Acute cerebrovascular disease                                                              & 0.619(0.703, 0.537) & 0.118 (0.192, 0.076) 
Acute myocardial infarction                                                                & 0.469(0.532, 0.409) & 0.079 (0.106, 0.063) 
Cardiac dysrhythmias                                                                       & 0.535(0.577, 0.496) & 0.381 (0.435, 0.338) 
Chronic kidney disease                                                                     & 0.526(0.571, 0.481) & 0.265 (0.320, 0.223) 
Chronic obstructive pulmonary disease and bronchiectasis                                   & 0.564(0.616, 0.516) & 0.240 (0.300, 0.197) 
Complications of surgical procedures or medical care                                       & 0.532(0.576, 0.488) & 0.237 (0.288, 0.202) 
Conduction disorders                                                                       & 0.511(0.570, 0.452) & 0.120 (0.159, 0.097) 
Congestive heart failure; nonhypertensive                                                  & 0.600(0.642, 0.559) & 0.409 (0.469, 0.359) 
Coronary atherosclerosis and other heart disease                                           & 0.517(0.558, 0.476) & 0.342 (0.395, 0.302) 
Diabetes mellitus with complications                                                       & 0.532(0.591, 0.476) & 0.137 (0.177, 0.108) 
Diabetes mellitus without complication                                                     & 0.535(0.584, 0.487) & 0.216 (0.263, 0.185) 
Disorders of lipid metabolism                                                              & 0.521(0.558, 0.484) & 0.477 (0.530, 0.436) 
Essential hypertension                                                                     & 0.479(0.516, 0.441) & 0.432 (0.482, 0.390) 
Fluid and electrolyte disorders                                                            & 0.563(0.600, 0.527) & 0.495 (0.551, 0.448) 
Gastrointestinal hemorrhage                                                                & 0.481(0.547, 0.412) & 0.066 (0.112, 0.048) 
Hypertension with complications and secondary hypertension                                 & 0.470(0.517, 0.424) & 0.206 (0.254, 0.173) 
Other liver diseases                                                                       & 0.582(0.643, 0.528) & 0.194 (0.263, 0.154) 
Other lower respiratory disease                                                            & 0.513(0.567, 0.450) & 0.140 (0.184, 0.109) 
Other upper respiratory disease                                                            & 0.539(0.609, 0.470) & 0.105 (0.158, 0.080) 
Pleurisy; pneumothorax; pulmonary collapse                                                 & 0.525(0.588, 0.464) & 0.127 (0.175, 0.096) 
Pneumonia (except that caused by tuberculosis or sexually transmitted disease)             & 0.596(0.642, 0.547) & 0.277 (0.345, 0.223) 
Respiratory failure; insufficiency; arrest (adult)                                         & 0.646(0.688, 0.608) & 0.433 (0.494, 0.382) 
Septicemia (except in labor)                                                               & 0.545(0.590, 0.497) & 0.239 (0.286, 0.201) 
Shock                                                                                      & 0.628(0.672, 0.577) & 0.298 (0.369, 0.247) 



val  7   best mean auc :0.544 mean auprc 0.258 


                    CI AUROC (0.494, 0.595) CI AUPRC (0.220, 0.312) 


                     AUROC accute 0.557 mixed 0.552 chronic 0.516


                     AUROC accute CI (0.502, 0.610) mixed (0.502 , 0.605) chronic (0.472, 0.560)


                     AUPRC accute  0.233 mixed 0.248 chronic 0.311 


                     AUPRC accute CI  (0.196, 0.288) mixed (0.211,  0.301) chronic (0.272, 0.364) 


                    
starting train epoch 7
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0007 / 0050] [0009/484] eta: 0 Days 15:8:42        lr: 	3.8330E-05 loss: 	0.53806 loss align 0.0000
 epoch [0007 / 0050] [0109/484] eta: 0 Days 14:56:14       lr: 	3.8330E-05 loss: 	0.48406 loss align 0.0000
 epoch [0007 / 0050] [0209/484] eta: 0 Days 14:44:31       lr: 	3.8330E-05 loss: 	0.48177 loss align 0.0000
 epoch [0007 / 0050] [0309/484] eta: 0 Days 14:33:21       lr: 	3.8330E-05 loss: 	0.48363 loss align 0.0000
 epoch [0007 / 0050] [0409/484] eta: 0 Days 14:22:36       lr: 	3.8330E-05 loss: 	0.48372 loss align 0.0000
starting val epoch 8
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0008 / 0050] validation loss: 	0.49743 	0.00000
saving last checkpoint at epoch 8
saving best checkpoint at epoch 8
Acute and unspecified renal failure                                                        & 0.579(0.621, 0.536) & 0.416 (0.477, 0.364) 
Acute cerebrovascular disease                                                              & 0.613(0.703, 0.522) & 0.123 (0.198, 0.082) 
Acute myocardial infarction                                                                & 0.467(0.525, 0.401) & 0.080 (0.108, 0.062) 
Cardiac dysrhythmias                                                                       & 0.535(0.574, 0.494) & 0.379 (0.429, 0.333) 
Chronic kidney disease                                                                     & 0.539(0.583, 0.496) & 0.274 (0.329, 0.226) 
Chronic obstructive pulmonary disease and bronchiectasis                                   & 0.567(0.618, 0.516) & 0.239 (0.299, 0.197) 
Complications of surgical procedures or medical care                                       & 0.529(0.575, 0.485) & 0.232 (0.277, 0.197) 
Conduction disorders                                                                       & 0.523(0.582, 0.460) & 0.125 (0.168, 0.099) 
Congestive heart failure; nonhypertensive                                                  & 0.589(0.629, 0.548) & 0.376 (0.433, 0.333) 
Coronary atherosclerosis and other heart disease                                           & 0.517(0.560, 0.474) & 0.344 (0.398, 0.302) 
Diabetes mellitus with complications                                                       & 0.537(0.594, 0.482) & 0.141 (0.186, 0.113) 
Diabetes mellitus without complication                                                     & 0.530(0.576, 0.483) & 0.215 (0.257, 0.182) 
Disorders of lipid metabolism                                                              & 0.510(0.548, 0.473) & 0.464 (0.512, 0.418) 
Essential hypertension                                                                     & 0.487(0.526, 0.448) & 0.442 (0.491, 0.398) 
Fluid and electrolyte disorders                                                            & 0.558(0.598, 0.519) & 0.486 (0.541, 0.437) 
Gastrointestinal hemorrhage                                                                & 0.479(0.557, 0.404) & 0.064 (0.099, 0.047) 
Hypertension with complications and secondary hypertension                                 & 0.478(0.528, 0.431) & 0.214 (0.260, 0.177) 
Other liver diseases                                                                       & 0.585(0.641, 0.526) & 0.202 (0.271, 0.154) 
Other lower respiratory disease                                                            & 0.523(0.576, 0.469) & 0.137 (0.178, 0.111) 
Other upper respiratory disease                                                            & 0.545(0.608, 0.482) & 0.102 (0.148, 0.079) 
Pleurisy; pneumothorax; pulmonary collapse                                                 & 0.528(0.590, 0.466) & 0.133 (0.186, 0.103) 
Pneumonia (except that caused by tuberculosis or sexually transmitted disease)             & 0.608(0.655, 0.558) & 0.285 (0.345, 0.232) 
Respiratory failure; insufficiency; arrest (adult)                                         & 0.644(0.680, 0.605) & 0.432 (0.492, 0.380) 
Septicemia (except in labor)                                                               & 0.567(0.610, 0.520) & 0.266 (0.327, 0.222) 
Shock                                                                                      & 0.630(0.676, 0.584) & 0.297 (0.365, 0.242) 



val  8   best mean auc :0.547 mean auprc 0.259 


                    CI AUROC (0.495, 0.597) CI AUPRC (0.220, 0.311) 


                     AUROC accute 0.559 mixed 0.554 chronic 0.518


                     AUROC accute CI (0.504, 0.613) mixed (0.502 , 0.604) chronic (0.474, 0.563)


                     AUPRC accute  0.235 mixed 0.244 chronic 0.313 


                     AUPRC accute CI  (0.197, 0.288) mixed (0.206,  0.297) chronic (0.272, 0.364) 


                    
starting train epoch 8
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0008 / 0050] [0009/484] eta: 0 Days 14:44:30       lr: 	3.8330E-05 loss: 	0.52712 loss align 0.0000
 epoch [0008 / 0050] [0109/484] eta: 0 Days 14:33:33       lr: 	3.8330E-05 loss: 	0.49042 loss align 0.0000
 epoch [0008 / 0050] [0209/484] eta: 0 Days 14:23:1        lr: 	3.8330E-05 loss: 	0.48668 loss align 0.0000
 epoch [0008 / 0050] [0309/484] eta: 0 Days 14:12:53       lr: 	3.8330E-05 loss: 	0.48589 loss align 0.0000
 epoch [0008 / 0050] [0409/484] eta: 0 Days 14:2:58        lr: 	3.8330E-05 loss: 	0.48516 loss align 0.0000
starting val epoch 9
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0009 / 0050] validation loss: 	0.49658 	0.00000
saving last checkpoint at epoch 9
saving best checkpoint at epoch 9
Acute and unspecified renal failure                                                        & 0.568(0.608, 0.527) & 0.396 (0.454, 0.347) 
Acute cerebrovascular disease                                                              & 0.660(0.736, 0.571) & 0.143 (0.239, 0.096) 
Acute myocardial infarction                                                                & 0.493(0.556, 0.427) & 0.085 (0.116, 0.067) 
Cardiac dysrhythmias                                                                       & 0.536(0.576, 0.497) & 0.374 (0.424, 0.331) 
Chronic kidney disease                                                                     & 0.569(0.611, 0.523) & 0.288 (0.346, 0.243) 
Chronic obstructive pulmonary disease and bronchiectasis                                   & 0.558(0.605, 0.508) & 0.240 (0.295, 0.198) 
Complications of surgical procedures or medical care                                       & 0.538(0.589, 0.489) & 0.234 (0.282, 0.197) 
Conduction disorders                                                                       & 0.545(0.605, 0.488) & 0.133 (0.175, 0.107) 
Congestive heart failure; nonhypertensive                                                  & 0.601(0.640, 0.562) & 0.399 (0.455, 0.348) 
Coronary atherosclerosis and other heart disease                                           & 0.538(0.580, 0.499) & 0.356 (0.408, 0.314) 
Diabetes mellitus with complications                                                       & 0.549(0.606, 0.488) & 0.142 (0.180, 0.115) 
Diabetes mellitus without complication                                                     & 0.549(0.596, 0.502) & 0.234 (0.283, 0.196) 
Disorders of lipid metabolism                                                              & 0.526(0.566, 0.489) & 0.472 (0.518, 0.427) 
Essential hypertension                                                                     & 0.496(0.538, 0.460) & 0.445 (0.495, 0.403) 
Fluid and electrolyte disorders                                                            & 0.553(0.592, 0.516) & 0.489 (0.544, 0.442) 
Gastrointestinal hemorrhage                                                                & 0.474(0.545, 0.395) & 0.065 (0.101, 0.048) 
Hypertension with complications and secondary hypertension                                 & 0.493(0.538, 0.444) & 0.222 (0.276, 0.185) 
Other liver diseases                                                                       & 0.577(0.629, 0.516) & 0.189 (0.249, 0.148) 
Other lower respiratory disease                                                            & 0.530(0.582, 0.476) & 0.138 (0.180, 0.112) 
Other upper respiratory disease                                                            & 0.559(0.626, 0.492) & 0.108 (0.153, 0.081) 
Pleurisy; pneumothorax; pulmonary collapse                                                 & 0.508(0.571, 0.448) & 0.125 (0.177, 0.097) 
Pneumonia (except that caused by tuberculosis or sexually transmitted disease)             & 0.616(0.660, 0.567) & 0.291 (0.359, 0.235) 
Respiratory failure; insufficiency; arrest (adult)                                         & 0.667(0.706, 0.627) & 0.445 (0.511, 0.387) 
Septicemia (except in labor)                                                               & 0.574(0.617, 0.529) & 0.256 (0.310, 0.217) 
Shock                                                                                      & 0.654(0.699, 0.608) & 0.337 (0.418, 0.281) 



val  9   best mean auc :0.557 mean auprc 0.264 


                    CI AUROC (0.506, 0.607) CI AUPRC (0.225, 0.318) 


                     AUROC accute 0.569 mixed 0.562 chronic 0.533


                     AUROC accute CI (0.513, 0.622) mixed (0.510 , 0.611) chronic (0.489, 0.576)


                     AUPRC accute  0.240 mixed 0.247 chronic 0.322 


                     AUPRC accute CI  (0.201, 0.296) mixed (0.210,  0.297) chronic (0.281, 0.375) 


                    
starting train epoch 9
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0009 / 0050] [0009/484] eta: 0 Days 14:21:1        lr: 	3.8330E-05 loss: 	0.54612 loss align 0.0000
 epoch [0009 / 0050] [0109/484] eta: 0 Days 14:11:2        lr: 	3.8330E-05 loss: 	0.48878 loss align 0.0000
 epoch [0009 / 0050] [0209/484] eta: 0 Days 14:1:21        lr: 	3.8330E-05 loss: 	0.48758 loss align 0.0000
 epoch [0009 / 0050] [0309/484] eta: 0 Days 13:51:56       lr: 	3.8330E-05 loss: 	0.48530 loss align 0.0000
 epoch [0009 / 0050] [0409/484] eta: 0 Days 13:42:54       lr: 	3.8330E-05 loss: 	0.48398 loss align 0.0000
starting val epoch 10
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0010 / 0050] validation loss: 	0.49769 	0.00000
saving last checkpoint at epoch 10



val  10  mean auc :0.556288 mean auprc 0.265015


 
starting train epoch 10
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0010 / 0050] [0009/484] eta: 0 Days 13:58:23       lr: 	3.8330E-05 loss: 	0.54094 loss align 0.0000
 epoch [0010 / 0050] [0109/484] eta: 0 Days 13:49:9        lr: 	3.8330E-05 loss: 	0.48678 loss align 0.0000
 epoch [0010 / 0050] [0209/484] eta: 0 Days 13:40:10       lr: 	3.8330E-05 loss: 	0.48530 loss align 0.0000
 epoch [0010 / 0050] [0309/484] eta: 0 Days 13:31:20       lr: 	3.8330E-05 loss: 	0.48463 loss align 0.0000
 epoch [0010 / 0050] [0409/484] eta: 0 Days 13:22:50       lr: 	3.8330E-05 loss: 	0.48502 loss align 0.0000
starting val epoch 11
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0011 / 0050] validation loss: 	0.49636 	0.00000
saving last checkpoint at epoch 11
saving best checkpoint at epoch 11
Acute and unspecified renal failure                                                        & 0.591(0.630, 0.549) & 0.432 (0.492, 0.380) 
Acute cerebrovascular disease                                                              & 0.662(0.743, 0.569) & 0.148 (0.242, 0.094) 
Acute myocardial infarction                                                                & 0.484(0.544, 0.423) & 0.081 (0.109, 0.063) 
Cardiac dysrhythmias                                                                       & 0.538(0.578, 0.498) & 0.375 (0.429, 0.333) 
Chronic kidney disease                                                                     & 0.562(0.606, 0.519) & 0.283 (0.339, 0.237) 
Chronic obstructive pulmonary disease and bronchiectasis                                   & 0.561(0.610, 0.509) & 0.244 (0.304, 0.198) 
Complications of surgical procedures or medical care                                       & 0.546(0.592, 0.499) & 0.238 (0.287, 0.203) 
Conduction disorders                                                                       & 0.536(0.598, 0.477) & 0.133 (0.177, 0.107) 
Congestive heart failure; nonhypertensive                                                  & 0.611(0.651, 0.573) & 0.404 (0.462, 0.356) 
Coronary atherosclerosis and other heart disease                                           & 0.535(0.580, 0.492) & 0.357 (0.411, 0.314) 
Diabetes mellitus with complications                                                       & 0.571(0.631, 0.513) & 0.159 (0.210, 0.125) 
Diabetes mellitus without complication                                                     & 0.548(0.592, 0.498) & 0.228 (0.276, 0.190) 
Disorders of lipid metabolism                                                              & 0.543(0.582, 0.504) & 0.481 (0.532, 0.437) 
Essential hypertension                                                                     & 0.486(0.523, 0.447) & 0.430 (0.479, 0.387) 
Fluid and electrolyte disorders                                                            & 0.561(0.599, 0.522) & 0.490 (0.544, 0.447) 
Gastrointestinal hemorrhage                                                                & 0.473(0.549, 0.400) & 0.062 (0.093, 0.046) 
Hypertension with complications and secondary hypertension                                 & 0.489(0.535, 0.441) & 0.211 (0.262, 0.180) 
Other liver diseases                                                                       & 0.592(0.648, 0.532) & 0.207 (0.277, 0.156) 
Other lower respiratory disease                                                            & 0.518(0.578, 0.460) & 0.134 (0.175, 0.108) 
Other upper respiratory disease                                                            & 0.557(0.620, 0.489) & 0.103 (0.142, 0.076) 
Pleurisy; pneumothorax; pulmonary collapse                                                 & 0.531(0.591, 0.473) & 0.125 (0.169, 0.097) 
Pneumonia (except that caused by tuberculosis or sexually transmitted disease)             & 0.629(0.673, 0.581) & 0.291 (0.355, 0.237) 
Respiratory failure; insufficiency; arrest (adult)                                         & 0.666(0.701, 0.623) & 0.445 (0.506, 0.389) 
Septicemia (except in labor)                                                               & 0.590(0.637, 0.546) & 0.288 (0.347, 0.244) 
Shock                                                                                      & 0.646(0.690, 0.600) & 0.337 (0.409, 0.281) 



val  11  best mean auc :0.561 mean auprc 0.268 


                    CI AUROC (0.509, 0.611) CI AUPRC (0.227, 0.321) 


                     AUROC accute 0.573 mixed 0.570 chronic 0.532


                     AUROC accute CI (0.518, 0.627) mixed (0.518 , 0.621) chronic (0.487, 0.575)


                     AUPRC accute  0.244 mixed 0.256 chronic 0.319 


                     AUPRC accute CI  (0.205, 0.298) mixed (0.215,  0.311) chronic (0.277, 0.372) 


                    
starting train epoch 11
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0011 / 0050] [0009/484] eta: 0 Days 13:35:44       lr: 	3.8330E-05 loss: 	0.52199 loss align 0.0000
 epoch [0011 / 0050] [0109/484] eta: 0 Days 13:27:6        lr: 	3.8330E-05 loss: 	0.48536 loss align 0.0000
 epoch [0011 / 0050] [0209/484] eta: 0 Days 13:18:46       lr: 	3.8330E-05 loss: 	0.48437 loss align 0.0000
 epoch [0011 / 0050] [0309/484] eta: 0 Days 13:10:38       lr: 	3.8330E-05 loss: 	0.48353 loss align 0.0000
 epoch [0011 / 0050] [0409/484] eta: 0 Days 13:2:40        lr: 	3.8330E-05 loss: 	0.48451 loss align 0.0000
starting val epoch 12
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0012 / 0050] validation loss: 	0.49564 	0.00000
saving last checkpoint at epoch 12
saving best checkpoint at epoch 12
Acute and unspecified renal failure                                                        & 0.593(0.633, 0.551) & 0.436 (0.498, 0.381) 
Acute cerebrovascular disease                                                              & 0.663(0.745, 0.577) & 0.154 (0.245, 0.098) 
Acute myocardial infarction                                                                & 0.471(0.533, 0.410) & 0.081 (0.113, 0.062) 
Cardiac dysrhythmias                                                                       & 0.544(0.585, 0.508) & 0.382 (0.437, 0.339) 
Chronic kidney disease                                                                     & 0.558(0.602, 0.513) & 0.281 (0.341, 0.237) 
Chronic obstructive pulmonary disease and bronchiectasis                                   & 0.570(0.620, 0.523) & 0.244 (0.308, 0.198) 
Complications of surgical procedures or medical care                                       & 0.533(0.582, 0.482) & 0.232 (0.281, 0.201) 
Conduction disorders                                                                       & 0.554(0.610, 0.501) & 0.139 (0.187, 0.110) 
Congestive heart failure; nonhypertensive                                                  & 0.619(0.662, 0.580) & 0.414 (0.480, 0.367) 
Coronary atherosclerosis and other heart disease                                           & 0.538(0.577, 0.500) & 0.361 (0.412, 0.313) 
Diabetes mellitus with complications                                                       & 0.570(0.630, 0.510) & 0.158 (0.212, 0.123) 
Diabetes mellitus without complication                                                     & 0.564(0.610, 0.516) & 0.234 (0.283, 0.198) 
Disorders of lipid metabolism                                                              & 0.523(0.559, 0.485) & 0.472 (0.522, 0.429) 
Essential hypertension                                                                     & 0.496(0.535, 0.460) & 0.436 (0.486, 0.392) 
Fluid and electrolyte disorders                                                            & 0.571(0.610, 0.533) & 0.513 (0.564, 0.463) 
Gastrointestinal hemorrhage                                                                & 0.482(0.556, 0.409) & 0.062 (0.092, 0.046) 
Hypertension with complications and secondary hypertension                                 & 0.483(0.530, 0.435) & 0.206 (0.250, 0.170) 
Other liver diseases                                                                       & 0.586(0.644, 0.531) & 0.205 (0.276, 0.162) 
Other lower respiratory disease                                                            & 0.531(0.586, 0.477) & 0.142 (0.184, 0.114) 
Other upper respiratory disease                                                            & 0.563(0.627, 0.501) & 0.104 (0.146, 0.079) 
Pleurisy; pneumothorax; pulmonary collapse                                                 & 0.538(0.602, 0.476) & 0.135 (0.191, 0.104) 
Pneumonia (except that caused by tuberculosis or sexually transmitted disease)             & 0.621(0.667, 0.576) & 0.283 (0.346, 0.233) 
Respiratory failure; insufficiency; arrest (adult)                                         & 0.662(0.700, 0.621) & 0.442 (0.505, 0.389) 
Septicemia (except in labor)                                                               & 0.602(0.646, 0.556) & 0.305 (0.371, 0.254) 
Shock                                                                                      & 0.645(0.695, 0.599) & 0.345 (0.421, 0.285) 



val  12  best mean auc :0.563 mean auprc 0.271 


                    CI AUROC (0.513, 0.614) CI AUPRC (0.230, 0.326) 


                     AUROC accute 0.575 mixed 0.575 chronic 0.533


                     AUROC accute CI (0.521, 0.629) mixed (0.526 , 0.626) chronic (0.490, 0.576)


                     AUPRC accute  0.249 mixed 0.260 chronic 0.319 


                     AUPRC accute CI  (0.209, 0.304) mixed (0.220,  0.319) chronic (0.277, 0.372) 


                    
starting train epoch 12
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0012 / 0050] [0009/484] eta: 0 Days 13:13:45       lr: 	3.8330E-05 loss: 	0.50402 loss align 0.0000
 epoch [0012 / 0050] [0109/484] eta: 0 Days 13:5:38        lr: 	3.8330E-05 loss: 	0.48603 loss align 0.0000
 epoch [0012 / 0050] [0209/484] eta: 0 Days 12:57:44       lr: 	3.8330E-05 loss: 	0.48424 loss align 0.0000
 epoch [0012 / 0050] [0309/484] eta: 0 Days 12:50:2        lr: 	3.8330E-05 loss: 	0.48450 loss align 0.0000
 epoch [0012 / 0050] [0409/484] eta: 0 Days 12:42:27       lr: 	3.8330E-05 loss: 	0.48401 loss align 0.0000
starting val epoch 13
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0013 / 0050] validation loss: 	0.49598 	0.00000
saving last checkpoint at epoch 13
saving best checkpoint at epoch 13
Acute and unspecified renal failure                                                        & 0.596(0.637, 0.553) & 0.439 (0.500, 0.386) 
Acute cerebrovascular disease                                                              & 0.669(0.752, 0.586) & 0.160 (0.251, 0.103) 
Acute myocardial infarction                                                                & 0.482(0.545, 0.422) & 0.084 (0.122, 0.067) 
Cardiac dysrhythmias                                                                       & 0.541(0.581, 0.501) & 0.380 (0.433, 0.336) 
Chronic kidney disease                                                                     & 0.579(0.621, 0.535) & 0.289 (0.348, 0.246) 
Chronic obstructive pulmonary disease and bronchiectasis                                   & 0.568(0.617, 0.520) & 0.245 (0.308, 0.198) 
Complications of surgical procedures or medical care                                       & 0.538(0.588, 0.490) & 0.234 (0.281, 0.197) 
Conduction disorders                                                                       & 0.567(0.625, 0.508) & 0.145 (0.200, 0.114) 
Congestive heart failure; nonhypertensive                                                  & 0.620(0.658, 0.581) & 0.417 (0.478, 0.364) 
Coronary atherosclerosis and other heart disease                                           & 0.551(0.591, 0.513) & 0.371 (0.426, 0.325) 
Diabetes mellitus with complications                                                       & 0.576(0.634, 0.518) & 0.161 (0.218, 0.126) 
Diabetes mellitus without complication                                                     & 0.579(0.623, 0.528) & 0.245 (0.299, 0.205) 
Disorders of lipid metabolism                                                              & 0.532(0.569, 0.495) & 0.477 (0.529, 0.436) 
Essential hypertension                                                                     & 0.504(0.543, 0.467) & 0.449 (0.499, 0.404) 
Fluid and electrolyte disorders                                                            & 0.560(0.597, 0.522) & 0.496 (0.551, 0.450) 
Gastrointestinal hemorrhage                                                                & 0.492(0.563, 0.422) & 0.065 (0.098, 0.047) 
Hypertension with complications and secondary hypertension                                 & 0.510(0.556, 0.459) & 0.229 (0.281, 0.190) 
Other liver diseases                                                                       & 0.573(0.625, 0.514) & 0.199 (0.264, 0.154) 
Other lower respiratory disease                                                            & 0.523(0.580, 0.464) & 0.145 (0.191, 0.113) 
Other upper respiratory disease                                                            & 0.554(0.620, 0.489) & 0.102 (0.141, 0.077) 
Pleurisy; pneumothorax; pulmonary collapse                                                 & 0.542(0.606, 0.484) & 0.140 (0.193, 0.110) 
Pneumonia (except that caused by tuberculosis or sexually transmitted disease)             & 0.627(0.672, 0.583) & 0.291 (0.358, 0.239) 
Respiratory failure; insufficiency; arrest (adult)                                         & 0.662(0.698, 0.625) & 0.440 (0.503, 0.391) 
Septicemia (except in labor)                                                               & 0.604(0.650, 0.560) & 0.306 (0.378, 0.258) 
Shock                                                                                      & 0.645(0.692, 0.596) & 0.352 (0.421, 0.284) 



val  13  best mean auc :0.568 mean auprc 0.274 


                    CI AUROC (0.517, 0.618) CI AUPRC (0.233, 0.331) 


                     AUROC accute 0.576 mixed 0.575 chronic 0.546


                     AUROC accute CI (0.523, 0.631) mixed (0.524 , 0.625) chronic (0.502, 0.588)


                     AUPRC accute  0.250 mixed 0.261 chronic 0.329 


                     AUPRC accute CI  (0.209, 0.307) mixed (0.219,  0.319) chronic (0.286, 0.384) 


                    
starting train epoch 13
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0013 / 0050] [0009/484] eta: 0 Days 12:51:51       lr: 	3.8330E-05 loss: 	0.53092 loss align 0.0000
 epoch [0013 / 0050] [0109/484] eta: 0 Days 12:44:13       lr: 	3.8330E-05 loss: 	0.47936 loss align 0.0000
 epoch [0013 / 0050] [0209/484] eta: 0 Days 12:36:42       lr: 	3.8330E-05 loss: 	0.48387 loss align 0.0000
 epoch [0013 / 0050] [0309/484] eta: 0 Days 12:29:19       lr: 	3.8330E-05 loss: 	0.48517 loss align 0.0000
 epoch [0013 / 0050] [0409/484] eta: 0 Days 12:22:5        lr: 	3.8330E-05 loss: 	0.48396 loss align 0.0000
starting val epoch 14
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0014 / 0050] validation loss: 	0.49622 	0.00000
saving last checkpoint at epoch 14
saving best checkpoint at epoch 14
Acute and unspecified renal failure                                                        & 0.602(0.640, 0.564) & 0.437 (0.501, 0.383) 
Acute cerebrovascular disease                                                              & 0.663(0.744, 0.579) & 0.151 (0.230, 0.100) 
Acute myocardial infarction                                                                & 0.471(0.537, 0.408) & 0.081 (0.115, 0.062) 
Cardiac dysrhythmias                                                                       & 0.540(0.580, 0.497) & 0.381 (0.434, 0.335) 
Chronic kidney disease                                                                     & 0.567(0.610, 0.524) & 0.288 (0.349, 0.242) 
Chronic obstructive pulmonary disease and bronchiectasis                                   & 0.574(0.625, 0.522) & 0.248 (0.312, 0.199) 
Complications of surgical procedures or medical care                                       & 0.536(0.587, 0.491) & 0.234 (0.284, 0.198) 
Conduction disorders                                                                       & 0.540(0.597, 0.481) & 0.135 (0.178, 0.106) 
Congestive heart failure; nonhypertensive                                                  & 0.619(0.660, 0.579) & 0.412 (0.471, 0.362) 
Coronary atherosclerosis and other heart disease                                           & 0.545(0.585, 0.504) & 0.369 (0.424, 0.322) 
Diabetes mellitus with complications                                                       & 0.573(0.626, 0.512) & 0.160 (0.212, 0.126) 
Diabetes mellitus without complication                                                     & 0.586(0.632, 0.538) & 0.249 (0.302, 0.208) 
Disorders of lipid metabolism                                                              & 0.547(0.585, 0.507) & 0.484 (0.535, 0.439) 
Essential hypertension                                                                     & 0.489(0.527, 0.447) & 0.430 (0.479, 0.387) 
Fluid and electrolyte disorders                                                            & 0.570(0.609, 0.531) & 0.516 (0.570, 0.461) 
Gastrointestinal hemorrhage                                                                & 0.484(0.567, 0.405) & 0.063 (0.094, 0.046) 
Hypertension with complications and secondary hypertension                                 & 0.505(0.556, 0.461) & 0.222 (0.272, 0.188) 
Other liver diseases                                                                       & 0.599(0.655, 0.545) & 0.210 (0.281, 0.164) 
Other lower respiratory disease                                                            & 0.534(0.593, 0.480) & 0.142 (0.185, 0.113) 
Other upper respiratory disease                                                            & 0.562(0.624, 0.496) & 0.103 (0.140, 0.078) 
Pleurisy; pneumothorax; pulmonary collapse                                                 & 0.555(0.616, 0.498) & 0.139 (0.195, 0.107) 
Pneumonia (except that caused by tuberculosis or sexually transmitted disease)             & 0.624(0.668, 0.576) & 0.284 (0.349, 0.231) 
Respiratory failure; insufficiency; arrest (adult)                                         & 0.670(0.706, 0.635) & 0.446 (0.506, 0.397) 
Septicemia (except in labor)                                                               & 0.599(0.646, 0.557) & 0.293 (0.352, 0.247) 
Shock                                                                                      & 0.642(0.689, 0.589) & 0.347 (0.423, 0.286) 



val  14  best mean auc :0.568 mean auprc 0.273 


                    CI AUROC (0.517, 0.618) CI AUPRC (0.231, 0.328) 


                     AUROC accute 0.578 mixed 0.574 chronic 0.545


                     AUROC accute CI (0.524, 0.633) mixed (0.523 , 0.623) chronic (0.501, 0.588)


                     AUPRC accute  0.249 mixed 0.259 chronic 0.327 


                     AUPRC accute CI  (0.208, 0.303) mixed (0.219,  0.315) chronic (0.284, 0.382) 


                    
starting train epoch 14
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0014 / 0050] [0009/484] eta: 0 Days 12:30:30       lr: 	3.8330E-05 loss: 	0.55551 loss align 0.0000
 epoch [0014 / 0050] [0109/484] eta: 0 Days 12:23:10       lr: 	3.8330E-05 loss: 	0.48742 loss align 0.0000
 epoch [0014 / 0050] [0209/484] eta: 0 Days 12:16:4        lr: 	3.8330E-05 loss: 	0.48768 loss align 0.0000
 epoch [0014 / 0050] [0309/484] eta: 0 Days 12:9:0         lr: 	3.8330E-05 loss: 	0.48572 loss align 0.0000
 epoch [0014 / 0050] [0409/484] eta: 0 Days 12:2:2         lr: 	3.8330E-05 loss: 	0.48432 loss align 0.0000
starting val epoch 15
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0015 / 0050] validation loss: 	0.49552 	0.00000
saving last checkpoint at epoch 15



val  15  mean auc :0.567452 mean auprc 0.273910


 
starting train epoch 15
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0015 / 0050] [0009/484] eta: 0 Days 12:9:2         lr: 	3.8330E-05 loss: 	0.53291 loss align 0.0000
 epoch [0015 / 0050] [0109/484] eta: 0 Days 12:2:3         lr: 	3.8330E-05 loss: 	0.49194 loss align 0.0000
 epoch [0015 / 0050] [0209/484] eta: 0 Days 11:55:11       lr: 	3.8330E-05 loss: 	0.48966 loss align 0.0000
 epoch [0015 / 0050] [0309/484] eta: 0 Days 11:48:22       lr: 	3.8330E-05 loss: 	0.48538 loss align 0.0000
 epoch [0015 / 0050] [0409/484] eta: 0 Days 11:41:41       lr: 	3.8330E-05 loss: 	0.48392 loss align 0.0000
starting val epoch 16
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0016 / 0050] validation loss: 	0.49635 	0.00000
saving last checkpoint at epoch 16
saving best checkpoint at epoch 16
Acute and unspecified renal failure                                                        & 0.609(0.651, 0.571) & 0.448 (0.515, 0.398) 
Acute cerebrovascular disease                                                              & 0.678(0.759, 0.590) & 0.169 (0.256, 0.107) 
Acute myocardial infarction                                                                & 0.491(0.553, 0.432) & 0.083 (0.111, 0.065) 
Cardiac dysrhythmias                                                                       & 0.537(0.578, 0.495) & 0.369 (0.423, 0.328) 
Chronic kidney disease                                                                     & 0.572(0.616, 0.528) & 0.291 (0.347, 0.242) 
Chronic obstructive pulmonary disease and bronchiectasis                                   & 0.575(0.625, 0.525) & 0.258 (0.320, 0.210) 
Complications of surgical procedures or medical care                                       & 0.540(0.585, 0.491) & 0.231 (0.276, 0.197) 
Conduction disorders                                                                       & 0.519(0.577, 0.459) & 0.128 (0.172, 0.102) 
Congestive heart failure; nonhypertensive                                                  & 0.625(0.664, 0.587) & 0.411 (0.473, 0.364) 
Coronary atherosclerosis and other heart disease                                           & 0.543(0.582, 0.504) & 0.360 (0.410, 0.316) 
Diabetes mellitus with complications                                                       & 0.597(0.652, 0.540) & 0.174 (0.227, 0.137) 
Diabetes mellitus without complication                                                     & 0.586(0.632, 0.539) & 0.253 (0.306, 0.212) 
Disorders of lipid metabolism                                                              & 0.537(0.574, 0.499) & 0.480 (0.530, 0.437) 
Essential hypertension                                                                     & 0.489(0.527, 0.452) & 0.430 (0.480, 0.386) 
Fluid and electrolyte disorders                                                            & 0.567(0.607, 0.532) & 0.513 (0.564, 0.465) 
Gastrointestinal hemorrhage                                                                & 0.483(0.557, 0.412) & 0.063 (0.093, 0.047) 
Hypertension with complications and secondary hypertension                                 & 0.493(0.542, 0.448) & 0.211 (0.253, 0.178) 
Other liver diseases                                                                       & 0.601(0.657, 0.546) & 0.219 (0.287, 0.170) 
Other lower respiratory disease                                                            & 0.512(0.570, 0.452) & 0.142 (0.191, 0.112) 
Other upper respiratory disease                                                            & 0.567(0.631, 0.501) & 0.105 (0.145, 0.079) 
Pleurisy; pneumothorax; pulmonary collapse                                                 & 0.564(0.624, 0.501) & 0.141 (0.198, 0.107) 
Pneumonia (except that caused by tuberculosis or sexually transmitted disease)             & 0.627(0.674, 0.584) & 0.287 (0.351, 0.232) 
Respiratory failure; insufficiency; arrest (adult)                                         & 0.670(0.705, 0.630) & 0.448 (0.508, 0.395) 
Septicemia (except in labor)                                                               & 0.618(0.666, 0.569) & 0.321 (0.397, 0.269) 
Shock                                                                                      & 0.641(0.686, 0.593) & 0.352 (0.432, 0.293) 



val  16  best mean auc :0.570 mean auprc 0.275 


                    CI AUROC (0.519, 0.620) CI AUPRC (0.234, 0.330) 


                     AUROC accute 0.582 mixed 0.576 chronic 0.542


                     AUROC accute CI (0.527, 0.636) mixed (0.525 , 0.626) chronic (0.499, 0.585)


                     AUPRC accute  0.254 mixed 0.260 chronic 0.326 


                     AUPRC accute CI  (0.213, 0.310) mixed (0.220,  0.316) chronic (0.283, 0.378) 


                    
starting train epoch 16
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0016 / 0050] [0009/484] eta: 0 Days 11:47:41       lr: 	3.8330E-05 loss: 	0.54279 loss align 0.0000
 epoch [0016 / 0050] [0109/484] eta: 0 Days 11:40:54       lr: 	3.8330E-05 loss: 	0.48608 loss align 0.0000
 epoch [0016 / 0050] [0209/484] eta: 0 Days 11:34:16       lr: 	3.8330E-05 loss: 	0.48437 loss align 0.0000
 epoch [0016 / 0050] [0309/484] eta: 0 Days 11:27:41       lr: 	3.8330E-05 loss: 	0.48348 loss align 0.0000
 epoch [0016 / 0050] [0409/484] eta: 0 Days 11:21:12       lr: 	3.8330E-05 loss: 	0.48306 loss align 0.0000
starting val epoch 17
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0017 / 0050] validation loss: 	0.49508 	0.00000
saving last checkpoint at epoch 17
saving best checkpoint at epoch 17
Acute and unspecified renal failure                                                        & 0.610(0.649, 0.569) & 0.450 (0.513, 0.396) 
Acute cerebrovascular disease                                                              & 0.677(0.759, 0.590) & 0.156 (0.242, 0.106) 
Acute myocardial infarction                                                                & 0.475(0.537, 0.411) & 0.081 (0.108, 0.063) 
Cardiac dysrhythmias                                                                       & 0.546(0.587, 0.505) & 0.382 (0.438, 0.337) 
Chronic kidney disease                                                                     & 0.584(0.626, 0.545) & 0.296 (0.357, 0.252) 
Chronic obstructive pulmonary disease and bronchiectasis                                   & 0.574(0.624, 0.525) & 0.246 (0.304, 0.203) 
Complications of surgical procedures or medical care                                       & 0.543(0.591, 0.497) & 0.234 (0.283, 0.201) 
Conduction disorders                                                                       & 0.510(0.573, 0.450) & 0.122 (0.161, 0.099) 
Congestive heart failure; nonhypertensive                                                  & 0.625(0.663, 0.583) & 0.412 (0.470, 0.360) 
Coronary atherosclerosis and other heart disease                                           & 0.546(0.588, 0.509) & 0.366 (0.422, 0.325) 
Diabetes mellitus with complications                                                       & 0.590(0.646, 0.535) & 0.171 (0.230, 0.132) 
Diabetes mellitus without complication                                                     & 0.576(0.619, 0.528) & 0.243 (0.293, 0.205) 
Disorders of lipid metabolism                                                              & 0.528(0.564, 0.492) & 0.467 (0.518, 0.423) 
Essential hypertension                                                                     & 0.490(0.528, 0.451) & 0.430 (0.480, 0.390) 
Fluid and electrolyte disorders                                                            & 0.574(0.613, 0.535) & 0.519 (0.569, 0.469) 
Gastrointestinal hemorrhage                                                                & 0.477(0.552, 0.404) & 0.062 (0.091, 0.046) 
Hypertension with complications and secondary hypertension                                 & 0.519(0.565, 0.470) & 0.226 (0.276, 0.190) 
Other liver diseases                                                                       & 0.615(0.673, 0.564) & 0.224 (0.298, 0.177) 
Other lower respiratory disease                                                            & 0.539(0.594, 0.481) & 0.147 (0.196, 0.118) 
Other upper respiratory disease                                                            & 0.572(0.635, 0.509) & 0.105 (0.143, 0.079) 
Pleurisy; pneumothorax; pulmonary collapse                                                 & 0.567(0.632, 0.511) & 0.148 (0.212, 0.115) 
Pneumonia (except that caused by tuberculosis or sexually transmitted disease)             & 0.634(0.679, 0.587) & 0.283 (0.346, 0.234) 
Respiratory failure; insufficiency; arrest (adult)                                         & 0.669(0.707, 0.631) & 0.446 (0.509, 0.391) 
Septicemia (except in labor)                                                               & 0.619(0.662, 0.574) & 0.325 (0.393, 0.272) 
Shock                                                                                      & 0.640(0.690, 0.586) & 0.355 (0.433, 0.288) 



val  17  best mean auc :0.572 mean auprc 0.276 


                    CI AUROC (0.522, 0.622) CI AUPRC (0.235, 0.331) 


                     AUROC accute 0.584 mixed 0.577 chronic 0.545


                     AUROC accute CI (0.530, 0.638) mixed (0.527 , 0.628) chronic (0.503, 0.588)


                     AUPRC accute  0.255 mixed 0.262 chronic 0.325 


                     AUPRC accute CI  (0.214, 0.311) mixed (0.221,  0.319) chronic (0.284, 0.378) 


                    
starting train epoch 17
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0017 / 0050] [0009/484] eta: 0 Days 11:26:20       lr: 	3.8330E-05 loss: 	0.54946 loss align 0.0000
 epoch [0017 / 0050] [0109/484] eta: 0 Days 11:19:49       lr: 	3.8330E-05 loss: 	0.48944 loss align 0.0000
 epoch [0017 / 0050] [0209/484] eta: 0 Days 11:13:22       lr: 	3.8330E-05 loss: 	0.48551 loss align 0.0000
 epoch [0017 / 0050] [0309/484] eta: 0 Days 11:7:1         lr: 	3.8330E-05 loss: 	0.48481 loss align 0.0000
 epoch [0017 / 0050] [0409/484] eta: 0 Days 11:0:46        lr: 	3.8330E-05 loss: 	0.48440 loss align 0.0000
starting val epoch 18
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0018 / 0050] validation loss: 	0.49541 	0.00000
saving last checkpoint at epoch 18
saving best checkpoint at epoch 18
Acute and unspecified renal failure                                                        & 0.611(0.650, 0.569) & 0.452 (0.510, 0.398) 
Acute cerebrovascular disease                                                              & 0.678(0.757, 0.583) & 0.169 (0.265, 0.108) 
Acute myocardial infarction                                                                & 0.480(0.544, 0.422) & 0.082 (0.114, 0.064) 
Cardiac dysrhythmias                                                                       & 0.550(0.589, 0.513) & 0.384 (0.434, 0.337) 
Chronic kidney disease                                                                     & 0.575(0.613, 0.533) & 0.293 (0.350, 0.247) 
Chronic obstructive pulmonary disease and bronchiectasis                                   & 0.582(0.632, 0.535) & 0.250 (0.313, 0.202) 
Complications of surgical procedures or medical care                                       & 0.538(0.588, 0.490) & 0.231 (0.278, 0.197) 
Conduction disorders                                                                       & 0.503(0.559, 0.444) & 0.120 (0.160, 0.096) 
Congestive heart failure; nonhypertensive                                                  & 0.619(0.659, 0.580) & 0.413 (0.478, 0.362) 
Coronary atherosclerosis and other heart disease                                           & 0.552(0.592, 0.513) & 0.372 (0.426, 0.323) 
Diabetes mellitus with complications                                                       & 0.595(0.650, 0.538) & 0.175 (0.234, 0.137) 
Diabetes mellitus without complication                                                     & 0.587(0.633, 0.543) & 0.247 (0.300, 0.209) 
Disorders of lipid metabolism                                                              & 0.540(0.581, 0.502) & 0.479 (0.532, 0.435) 
Essential hypertension                                                                     & 0.490(0.527, 0.453) & 0.431 (0.475, 0.389) 
Fluid and electrolyte disorders                                                            & 0.571(0.607, 0.532) & 0.518 (0.570, 0.469) 
Gastrointestinal hemorrhage                                                                & 0.501(0.567, 0.425) & 0.071 (0.125, 0.048) 
Hypertension with complications and secondary hypertension                                 & 0.522(0.564, 0.474) & 0.228 (0.284, 0.190) 
Other liver diseases                                                                       & 0.605(0.657, 0.546) & 0.221 (0.296, 0.171) 
Other lower respiratory disease                                                            & 0.538(0.594, 0.476) & 0.150 (0.201, 0.120) 
Other upper respiratory disease                                                            & 0.562(0.625, 0.495) & 0.104 (0.145, 0.078) 
Pleurisy; pneumothorax; pulmonary collapse                                                 & 0.568(0.634, 0.506) & 0.152 (0.206, 0.118) 
Pneumonia (except that caused by tuberculosis or sexually transmitted disease)             & 0.624(0.670, 0.579) & 0.284 (0.347, 0.237) 
Respiratory failure; insufficiency; arrest (adult)                                         & 0.673(0.711, 0.635) & 0.445 (0.503, 0.392) 
Septicemia (except in labor)                                                               & 0.611(0.657, 0.560) & 0.320 (0.387, 0.262) 
Shock                                                                                      & 0.640(0.687, 0.591) & 0.352 (0.426, 0.291) 



val  18  best mean auc :0.573 mean auprc 0.278 


                    CI AUROC (0.522, 0.622) CI AUPRC (0.235, 0.334) 


                     AUROC accute 0.584 mixed 0.575 chronic 0.550


                     AUROC accute CI (0.528, 0.638) mixed (0.524 , 0.623) chronic (0.508, 0.592)


                     AUPRC accute  0.256 mixed 0.263 chronic 0.329 


                     AUPRC accute CI  (0.214, 0.314) mixed (0.221,  0.320) chronic (0.285, 0.383) 


                    
starting train epoch 18
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0018 / 0050] [0009/484] eta: 0 Days 11:5:11        lr: 	3.8330E-05 loss: 	0.56153 loss align 0.0000
 epoch [0018 / 0050] [0109/484] eta: 0 Days 10:58:52       lr: 	3.8330E-05 loss: 	0.48864 loss align 0.0000
 epoch [0018 / 0050] [0209/484] eta: 0 Days 10:52:38       lr: 	3.8330E-05 loss: 	0.48558 loss align 0.0000
 epoch [0018 / 0050] [0309/484] eta: 0 Days 10:46:27       lr: 	3.8330E-05 loss: 	0.48488 loss align 0.0000
 epoch [0018 / 0050] [0409/484] eta: 0 Days 10:40:20       lr: 	3.8330E-05 loss: 	0.48325 loss align 0.0000
starting val epoch 19
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0019 / 0050] validation loss: 	0.49457 	0.00000
saving last checkpoint at epoch 19
saving best checkpoint at epoch 19
Acute and unspecified renal failure                                                        & 0.606(0.644, 0.565) & 0.445 (0.507, 0.393) 
Acute cerebrovascular disease                                                              & 0.689(0.770, 0.600) & 0.170 (0.266, 0.114) 
Acute myocardial infarction                                                                & 0.490(0.551, 0.426) & 0.082 (0.110, 0.065) 
Cardiac dysrhythmias                                                                       & 0.545(0.586, 0.505) & 0.383 (0.432, 0.338) 
Chronic kidney disease                                                                     & 0.585(0.630, 0.541) & 0.300 (0.364, 0.251) 
Chronic obstructive pulmonary disease and bronchiectasis                                   & 0.576(0.622, 0.526) & 0.247 (0.306, 0.198) 
Complications of surgical procedures or medical care                                       & 0.545(0.592, 0.494) & 0.234 (0.279, 0.201) 
Conduction disorders                                                                       & 0.535(0.594, 0.480) & 0.130 (0.174, 0.102) 
Congestive heart failure; nonhypertensive                                                  & 0.622(0.661, 0.582) & 0.411 (0.473, 0.362) 
Coronary atherosclerosis and other heart disease                                           & 0.559(0.595, 0.519) & 0.376 (0.434, 0.329) 
Diabetes mellitus with complications                                                       & 0.598(0.653, 0.544) & 0.174 (0.230, 0.133) 
Diabetes mellitus without complication                                                     & 0.589(0.634, 0.542) & 0.249 (0.302, 0.208) 
Disorders of lipid metabolism                                                              & 0.548(0.586, 0.510) & 0.480 (0.534, 0.440) 
Essential hypertension                                                                     & 0.491(0.531, 0.449) & 0.433 (0.481, 0.391) 
Fluid and electrolyte disorders                                                            & 0.572(0.610, 0.536) & 0.519 (0.571, 0.475) 
Gastrointestinal hemorrhage                                                                & 0.493(0.565, 0.418) & 0.064 (0.097, 0.048) 
Hypertension with complications and secondary hypertension                                 & 0.518(0.560, 0.474) & 0.215 (0.259, 0.187) 
Other liver diseases                                                                       & 0.588(0.643, 0.531) & 0.213 (0.287, 0.166) 
Other lower respiratory disease                                                            & 0.549(0.605, 0.490) & 0.146 (0.190, 0.117) 
Other upper respiratory disease                                                            & 0.568(0.635, 0.504) & 0.105 (0.142, 0.080) 
Pleurisy; pneumothorax; pulmonary collapse                                                 & 0.561(0.628, 0.503) & 0.149 (0.208, 0.114) 
Pneumonia (except that caused by tuberculosis or sexually transmitted disease)             & 0.636(0.676, 0.589) & 0.284 (0.347, 0.235) 
Respiratory failure; insufficiency; arrest (adult)                                         & 0.672(0.708, 0.632) & 0.446 (0.513, 0.394) 
Septicemia (except in labor)                                                               & 0.619(0.664, 0.573) & 0.326 (0.396, 0.272) 
Shock                                                                                      & 0.641(0.688, 0.589) & 0.357 (0.436, 0.295) 



val  19  best mean auc :0.576 mean auprc 0.277 


                    CI AUROC (0.525, 0.625) CI AUPRC (0.236, 0.334) 


                     AUROC accute 0.588 mixed 0.577 chronic 0.552


                     AUROC accute CI (0.532, 0.641) mixed (0.529 , 0.627) chronic (0.509, 0.594)


                     AUPRC accute  0.256 mixed 0.262 chronic 0.328 


                     AUPRC accute CI  (0.216, 0.312) mixed (0.220,  0.319) chronic (0.286, 0.383) 


                    
starting train epoch 19
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0019 / 0050] [0009/484] eta: 0 Days 10:44:4        lr: 	3.8330E-05 loss: 	0.53081 loss align 0.0000
 epoch [0019 / 0050] [0109/484] eta: 0 Days 10:37:58       lr: 	3.8330E-05 loss: 	0.48506 loss align 0.0000
 epoch [0019 / 0050] [0209/484] eta: 0 Days 10:31:53       lr: 	3.8330E-05 loss: 	0.48180 loss align 0.0000
 epoch [0019 / 0050] [0309/484] eta: 0 Days 10:25:52       lr: 	3.8330E-05 loss: 	0.48279 loss align 0.0000
 epoch [0019 / 0050] [0409/484] eta: 0 Days 10:19:54       lr: 	3.8330E-05 loss: 	0.48254 loss align 0.0000
starting val epoch 20
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0020 / 0050] validation loss: 	0.49513 	0.00000
saving last checkpoint at epoch 20



val  20  mean auc :0.574679 mean auprc 0.277173


 
starting train epoch 20
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0020 / 0050] [0009/484] eta: 0 Days 10:23:3        lr: 	3.8330E-05 loss: 	0.51357 loss align 0.0000
 epoch [0020 / 0050] [0109/484] eta: 0 Days 10:17:5        lr: 	3.8330E-05 loss: 	0.48814 loss align 0.0000
 epoch [0020 / 0050] [0209/484] eta: 0 Days 10:11:9        lr: 	3.8330E-05 loss: 	0.48374 loss align 0.0000
 epoch [0020 / 0050] [0309/484] eta: 0 Days 10:5:17        lr: 	3.8330E-05 loss: 	0.48318 loss align 0.0000
 epoch [0020 / 0050] [0409/484] eta: 0 Days 9:59:26        lr: 	3.8330E-05 loss: 	0.48236 loss align 0.0000
starting val epoch 21
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0021 / 0050] validation loss: 	0.49487 	0.00000
saving last checkpoint at epoch 21
saving best checkpoint at epoch 21
Acute and unspecified renal failure                                                        & 0.614(0.652, 0.576) & 0.451 (0.509, 0.400) 
Acute cerebrovascular disease                                                              & 0.679(0.764, 0.596) & 0.154 (0.236, 0.104) 
Acute myocardial infarction                                                                & 0.501(0.561, 0.438) & 0.085 (0.112, 0.067) 
Cardiac dysrhythmias                                                                       & 0.553(0.593, 0.514) & 0.385 (0.435, 0.338) 
Chronic kidney disease                                                                     & 0.585(0.628, 0.539) & 0.294 (0.352, 0.248) 
Chronic obstructive pulmonary disease and bronchiectasis                                   & 0.584(0.634, 0.532) & 0.259 (0.320, 0.210) 
Complications of surgical procedures or medical care                                       & 0.535(0.584, 0.489) & 0.228 (0.267, 0.197) 
Conduction disorders                                                                       & 0.524(0.586, 0.467) & 0.129 (0.175, 0.103) 
Congestive heart failure; nonhypertensive                                                  & 0.626(0.667, 0.584) & 0.412 (0.471, 0.364) 
Coronary atherosclerosis and other heart disease                                           & 0.554(0.592, 0.513) & 0.378 (0.431, 0.334) 
Diabetes mellitus with complications                                                       & 0.608(0.662, 0.548) & 0.182 (0.238, 0.144) 
Diabetes mellitus without complication                                                     & 0.596(0.641, 0.549) & 0.255 (0.310, 0.216) 
Disorders of lipid metabolism                                                              & 0.547(0.586, 0.508) & 0.484 (0.535, 0.438) 
Essential hypertension                                                                     & 0.495(0.536, 0.457) & 0.437 (0.487, 0.396) 
Fluid and electrolyte disorders                                                            & 0.574(0.611, 0.536) & 0.518 (0.571, 0.470) 
Gastrointestinal hemorrhage                                                                & 0.510(0.585, 0.435) & 0.072 (0.123, 0.050) 
Hypertension with complications and secondary hypertension                                 & 0.537(0.582, 0.491) & 0.233 (0.283, 0.196) 
Other liver diseases                                                                       & 0.589(0.650, 0.535) & 0.220 (0.291, 0.170) 
Other lower respiratory disease                                                            & 0.520(0.581, 0.460) & 0.145 (0.196, 0.113) 
Other upper respiratory disease                                                            & 0.545(0.609, 0.481) & 0.101 (0.139, 0.076) 
Pleurisy; pneumothorax; pulmonary collapse                                                 & 0.568(0.631, 0.512) & 0.153 (0.217, 0.117) 
Pneumonia (except that caused by tuberculosis or sexually transmitted disease)             & 0.624(0.670, 0.579) & 0.282 (0.349, 0.229) 
Respiratory failure; insufficiency; arrest (adult)                                         & 0.668(0.705, 0.631) & 0.445 (0.505, 0.395) 
Septicemia (except in labor)                                                               & 0.619(0.663, 0.573) & 0.327 (0.396, 0.278) 
Shock                                                                                      & 0.643(0.696, 0.593) & 0.356 (0.438, 0.294) 



val  21  best mean auc :0.576 mean auprc 0.279 


                    CI AUROC (0.526, 0.627) CI AUPRC (0.238, 0.335) 


                     AUROC accute 0.585 mixed 0.580 chronic 0.557


                     AUROC accute CI (0.531, 0.640) mixed (0.530 , 0.631) chronic (0.513, 0.600)


                     AUPRC accute  0.255 mixed 0.266 chronic 0.334 


                     AUPRC accute CI  (0.215, 0.312) mixed (0.224,  0.322) chronic (0.291, 0.388) 


                    
starting train epoch 21
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0021 / 0050] [0009/484] eta: 0 Days 10:1:55        lr: 	3.8330E-05 loss: 	0.52162 loss align 0.0000
 epoch [0021 / 0050] [0109/484] eta: 0 Days 9:56:5         lr: 	3.8330E-05 loss: 	0.48759 loss align 0.0000
 epoch [0021 / 0050] [0209/484] eta: 0 Days 9:50:19        lr: 	3.8330E-05 loss: 	0.48488 loss align 0.0000
 epoch [0021 / 0050] [0309/484] eta: 0 Days 9:44:34        lr: 	3.8330E-05 loss: 	0.48272 loss align 0.0000
 epoch [0021 / 0050] [0409/484] eta: 0 Days 9:38:53        lr: 	3.8330E-05 loss: 	0.48245 loss align 0.0000
starting val epoch 22
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0022 / 0050] validation loss: 	0.49475 	0.00000
saving last checkpoint at epoch 22
saving best checkpoint at epoch 22
Acute and unspecified renal failure                                                        & 0.611(0.649, 0.571) & 0.438 (0.499, 0.390) 
Acute cerebrovascular disease                                                              & 0.687(0.766, 0.607) & 0.181 (0.287, 0.117) 
Acute myocardial infarction                                                                & 0.493(0.554, 0.430) & 0.084 (0.114, 0.067) 
Cardiac dysrhythmias                                                                       & 0.546(0.586, 0.507) & 0.381 (0.434, 0.334) 
Chronic kidney disease                                                                     & 0.575(0.616, 0.531) & 0.290 (0.352, 0.245) 
Chronic obstructive pulmonary disease and bronchiectasis                                   & 0.577(0.624, 0.526) & 0.250 (0.316, 0.206) 
Complications of surgical procedures or medical care                                       & 0.541(0.588, 0.492) & 0.230 (0.272, 0.196) 
Conduction disorders                                                                       & 0.519(0.580, 0.457) & 0.127 (0.170, 0.101) 
Congestive heart failure; nonhypertensive                                                  & 0.628(0.664, 0.588) & 0.410 (0.470, 0.363) 
Coronary atherosclerosis and other heart disease                                           & 0.561(0.601, 0.519) & 0.371 (0.428, 0.327) 
Diabetes mellitus with complications                                                       & 0.605(0.656, 0.549) & 0.178 (0.230, 0.137) 
Diabetes mellitus without complication                                                     & 0.594(0.637, 0.542) & 0.255 (0.308, 0.214) 
Disorders of lipid metabolism                                                              & 0.547(0.585, 0.508) & 0.481 (0.533, 0.436) 
Essential hypertension                                                                     & 0.498(0.536, 0.459) & 0.436 (0.486, 0.392) 
Fluid and electrolyte disorders                                                            & 0.567(0.604, 0.531) & 0.515 (0.569, 0.468) 
Gastrointestinal hemorrhage                                                                & 0.481(0.560, 0.402) & 0.062 (0.093, 0.047) 
Hypertension with complications and secondary hypertension                                 & 0.517(0.563, 0.471) & 0.218 (0.264, 0.183) 
Other liver diseases                                                                       & 0.609(0.665, 0.555) & 0.224 (0.298, 0.176) 
Other lower respiratory disease                                                            & 0.537(0.594, 0.475) & 0.147 (0.195, 0.118) 
Other upper respiratory disease                                                            & 0.574(0.634, 0.511) & 0.102 (0.134, 0.079) 
Pleurisy; pneumothorax; pulmonary collapse                                                 & 0.585(0.646, 0.524) & 0.151 (0.205, 0.117) 
Pneumonia (except that caused by tuberculosis or sexually transmitted disease)             & 0.634(0.677, 0.593) & 0.288 (0.352, 0.232) 
Respiratory failure; insufficiency; arrest (adult)                                         & 0.668(0.708, 0.630) & 0.448 (0.506, 0.393) 
Septicemia (except in labor)                                                               & 0.622(0.667, 0.574) & 0.311 (0.376, 0.259) 
Shock                                                                                      & 0.644(0.691, 0.593) & 0.362 (0.439, 0.294) 



val  22  best mean auc :0.577 mean auprc 0.278 


                    CI AUROC (0.526, 0.626) CI AUPRC (0.236, 0.333) 


                     AUROC accute 0.588 mixed 0.581 chronic 0.553


                     AUROC accute CI (0.533, 0.641) mixed (0.531 , 0.630) chronic (0.508, 0.595)


                     AUPRC accute  0.255 mixed 0.264 chronic 0.329 


                     AUPRC accute CI  (0.213, 0.311) mixed (0.222,  0.321) chronic (0.286, 0.384) 


                    
starting train epoch 22
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0022 / 0050] [0009/484] eta: 0 Days 9:40:55        lr: 	3.8330E-05 loss: 	0.55278 loss align 0.0000
 epoch [0022 / 0050] [0109/484] eta: 0 Days 9:35:12        lr: 	3.8330E-05 loss: 	0.48939 loss align 0.0000
 epoch [0022 / 0050] [0209/484] eta: 0 Days 9:29:33        lr: 	3.8330E-05 loss: 	0.48593 loss align 0.0000
 epoch [0022 / 0050] [0309/484] eta: 0 Days 9:23:57        lr: 	3.8330E-05 loss: 	0.48564 loss align 0.0000
 epoch [0022 / 0050] [0409/484] eta: 0 Days 9:18:22        lr: 	3.8330E-05 loss: 	0.48388 loss align 0.0000
starting val epoch 23
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0023 / 0050] validation loss: 	0.49476 	0.00000
saving last checkpoint at epoch 23
saving best checkpoint at epoch 23
Acute and unspecified renal failure                                                        & 0.607(0.648, 0.565) & 0.444 (0.508, 0.391) 
Acute cerebrovascular disease                                                              & 0.689(0.777, 0.604) & 0.168 (0.269, 0.114) 
Acute myocardial infarction                                                                & 0.495(0.552, 0.433) & 0.084 (0.112, 0.065) 
Cardiac dysrhythmias                                                                       & 0.549(0.588, 0.511) & 0.381 (0.434, 0.338) 
Chronic kidney disease                                                                     & 0.582(0.625, 0.535) & 0.294 (0.354, 0.249) 
Chronic obstructive pulmonary disease and bronchiectasis                                   & 0.576(0.625, 0.527) & 0.251 (0.319, 0.206) 
Complications of surgical procedures or medical care                                       & 0.544(0.594, 0.493) & 0.234 (0.279, 0.200) 
Conduction disorders                                                                       & 0.540(0.596, 0.481) & 0.133 (0.173, 0.105) 
Congestive heart failure; nonhypertensive                                                  & 0.621(0.660, 0.580) & 0.407 (0.464, 0.355) 
Coronary atherosclerosis and other heart disease                                           & 0.560(0.601, 0.520) & 0.373 (0.426, 0.330) 
Diabetes mellitus with complications                                                       & 0.614(0.671, 0.555) & 0.182 (0.241, 0.139) 
Diabetes mellitus without complication                                                     & 0.598(0.643, 0.551) & 0.257 (0.311, 0.215) 
Disorders of lipid metabolism                                                              & 0.551(0.591, 0.513) & 0.484 (0.533, 0.440) 
Essential hypertension                                                                     & 0.494(0.532, 0.454) & 0.430 (0.478, 0.388) 
Fluid and electrolyte disorders                                                            & 0.566(0.606, 0.529) & 0.510 (0.568, 0.456) 
Gastrointestinal hemorrhage                                                                & 0.494(0.573, 0.424) & 0.071 (0.121, 0.048) 
Hypertension with complications and secondary hypertension                                 & 0.532(0.582, 0.486) & 0.231 (0.280, 0.192) 
Other liver diseases                                                                       & 0.599(0.653, 0.543) & 0.224 (0.295, 0.172) 
Other lower respiratory disease                                                            & 0.530(0.587, 0.477) & 0.146 (0.192, 0.117) 
Other upper respiratory disease                                                            & 0.569(0.631, 0.508) & 0.102 (0.135, 0.078) 
Pleurisy; pneumothorax; pulmonary collapse                                                 & 0.585(0.642, 0.522) & 0.152 (0.206, 0.117) 
Pneumonia (except that caused by tuberculosis or sexually transmitted disease)             & 0.637(0.676, 0.591) & 0.289 (0.354, 0.239) 
Respiratory failure; insufficiency; arrest (adult)                                         & 0.679(0.714, 0.640) & 0.452 (0.515, 0.398) 
Septicemia (except in labor)                                                               & 0.623(0.669, 0.571) & 0.313 (0.376, 0.258) 
Shock                                                                                      & 0.648(0.699, 0.603) & 0.363 (0.442, 0.298) 



val  23  best mean auc :0.579 mean auprc 0.279 


                    CI AUROC (0.529, 0.629) CI AUPRC (0.236, 0.335) 


                     AUROC accute 0.590 mixed 0.585 chronic 0.556


                     AUROC accute CI (0.535, 0.644) mixed (0.534 , 0.634) chronic (0.512, 0.600)


                     AUPRC accute  0.256 mixed 0.265 chronic 0.332 


                     AUPRC accute CI  (0.214, 0.314) mixed (0.222,  0.321) chronic (0.289, 0.386) 


                    
starting train epoch 23
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0023 / 0050] [0009/484] eta: 0 Days 9:20:1         lr: 	3.8330E-05 loss: 	0.53519 loss align 0.0000
 epoch [0023 / 0050] [0109/484] eta: 0 Days 9:14:25        lr: 	3.8330E-05 loss: 	0.48285 loss align 0.0000
 epoch [0023 / 0050] [0209/484] eta: 0 Days 9:8:52         lr: 	3.8330E-05 loss: 	0.48154 loss align 0.0000
 epoch [0023 / 0050] [0309/484] eta: 0 Days 9:3:21         lr: 	3.8330E-05 loss: 	0.48264 loss align 0.0000
 epoch [0023 / 0050] [0409/484] eta: 0 Days 8:57:54        lr: 	3.8330E-05 loss: 	0.48229 loss align 0.0000
starting val epoch 24
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0024 / 0050] validation loss: 	0.49467 	0.00000
saving last checkpoint at epoch 24



val  24  mean auc :0.578058 mean auprc 0.277725


 
starting train epoch 24
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0024 / 0050] [0009/484] eta: 0 Days 8:59:3         lr: 	3.8330E-05 loss: 	0.55683 loss align 0.0000
 epoch [0024 / 0050] [0109/484] eta: 0 Days 8:53:34        lr: 	3.8330E-05 loss: 	0.48675 loss align 0.0000
 epoch [0024 / 0050] [0209/484] eta: 0 Days 8:48:7         lr: 	3.8330E-05 loss: 	0.48299 loss align 0.0000
 epoch [0024 / 0050] [0309/484] eta: 0 Days 8:42:44        lr: 	3.8330E-05 loss: 	0.48439 loss align 0.0000
 epoch [0024 / 0050] [0409/484] eta: 0 Days 8:37:22        lr: 	3.8330E-05 loss: 	0.48357 loss align 0.0000
starting val epoch 25
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0025 / 0050] validation loss: 	0.49444 	0.00000
saving last checkpoint at epoch 25



val  25  mean auc :0.577853 mean auprc 0.280428


 
starting train epoch 25
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0025 / 0050] [0009/484] eta: 0 Days 8:38:8         lr: 	3.8330E-05 loss: 	0.52724 loss align 0.0000
 epoch [0025 / 0050] [0109/484] eta: 0 Days 8:32:44        lr: 	3.8330E-05 loss: 	0.48438 loss align 0.0000
 epoch [0025 / 0050] [0209/484] eta: 0 Days 8:27:22        lr: 	3.8330E-05 loss: 	0.48068 loss align 0.0000
 epoch [0025 / 0050] [0309/484] eta: 0 Days 8:22:4         lr: 	3.8330E-05 loss: 	0.48098 loss align 0.0000
 epoch [0025 / 0050] [0409/484] eta: 0 Days 8:16:47        lr: 	3.8330E-05 loss: 	0.48233 loss align 0.0000
starting val epoch 26
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0026 / 0050] validation loss: 	0.49417 	0.00000
saving last checkpoint at epoch 26
saving best checkpoint at epoch 26
Acute and unspecified renal failure                                                        & 0.617(0.657, 0.576) & 0.455 (0.517, 0.398) 
Acute cerebrovascular disease                                                              & 0.694(0.770, 0.609) & 0.190 (0.296, 0.121) 
Acute myocardial infarction                                                                & 0.516(0.583, 0.453) & 0.088 (0.117, 0.068) 
Cardiac dysrhythmias                                                                       & 0.551(0.591, 0.510) & 0.381 (0.432, 0.338) 
Chronic kidney disease                                                                     & 0.568(0.614, 0.523) & 0.280 (0.333, 0.237) 
Chronic obstructive pulmonary disease and bronchiectasis                                   & 0.584(0.635, 0.533) & 0.263 (0.326, 0.210) 
Complications of surgical procedures or medical care                                       & 0.544(0.594, 0.501) & 0.233 (0.280, 0.203) 
Conduction disorders                                                                       & 0.521(0.582, 0.463) & 0.129 (0.172, 0.102) 
Congestive heart failure; nonhypertensive                                                  & 0.620(0.660, 0.581) & 0.390 (0.444, 0.345) 
Coronary atherosclerosis and other heart disease                                           & 0.567(0.604, 0.528) & 0.368 (0.425, 0.327) 
Diabetes mellitus with complications                                                       & 0.615(0.676, 0.557) & 0.180 (0.234, 0.142) 
Diabetes mellitus without complication                                                     & 0.598(0.642, 0.552) & 0.258 (0.312, 0.220) 
Disorders of lipid metabolism                                                              & 0.543(0.577, 0.505) & 0.476 (0.525, 0.435) 
Essential hypertension                                                                     & 0.497(0.535, 0.457) & 0.433 (0.482, 0.392) 
Fluid and electrolyte disorders                                                            & 0.569(0.605, 0.528) & 0.515 (0.565, 0.469) 
Gastrointestinal hemorrhage                                                                & 0.492(0.565, 0.415) & 0.067 (0.114, 0.048) 
Hypertension with complications and secondary hypertension                                 & 0.521(0.567, 0.474) & 0.218 (0.263, 0.187) 
Other liver diseases                                                                       & 0.597(0.650, 0.539) & 0.221 (0.290, 0.172) 
Other lower respiratory disease                                                            & 0.535(0.597, 0.477) & 0.149 (0.195, 0.117) 
Other upper respiratory disease                                                            & 0.579(0.641, 0.513) & 0.103 (0.139, 0.079) 
Pleurisy; pneumothorax; pulmonary collapse                                                 & 0.591(0.653, 0.530) & 0.154 (0.211, 0.119) 
Pneumonia (except that caused by tuberculosis or sexually transmitted disease)             & 0.641(0.688, 0.595) & 0.290 (0.356, 0.241) 
Respiratory failure; insufficiency; arrest (adult)                                         & 0.679(0.719, 0.643) & 0.452 (0.519, 0.400) 
Septicemia (except in labor)                                                               & 0.627(0.671, 0.577) & 0.322 (0.386, 0.268) 
Shock                                                                                      & 0.644(0.691, 0.596) & 0.363 (0.439, 0.296) 



val  26  best mean auc :0.580 mean auprc 0.279 


                    CI AUROC (0.529, 0.631) CI AUPRC (0.237, 0.335) 


                     AUROC accute 0.594 mixed 0.581 chronic 0.554


                     AUROC accute CI (0.539, 0.649) mixed (0.530 , 0.632) chronic (0.510, 0.596)


                     AUPRC accute  0.260 mixed 0.260 chronic 0.328 


                     AUPRC accute CI  (0.217, 0.318) mixed (0.220,  0.314) chronic (0.287, 0.381) 


                    
starting train epoch 26
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0026 / 0050] [0009/484] eta: 0 Days 8:17:15        lr: 	3.8330E-05 loss: 	0.51661 loss align 0.0000
 epoch [0026 / 0050] [0109/484] eta: 0 Days 8:11:58        lr: 	3.8330E-05 loss: 	0.47861 loss align 0.0000
 epoch [0026 / 0050] [0209/484] eta: 0 Days 8:6:43         lr: 	3.8330E-05 loss: 	0.48266 loss align 0.0000
 epoch [0026 / 0050] [0309/484] eta: 0 Days 8:1:29         lr: 	3.8330E-05 loss: 	0.48211 loss align 0.0000
 epoch [0026 / 0050] [0409/484] eta: 0 Days 7:56:16        lr: 	3.8330E-05 loss: 	0.48178 loss align 0.0000
starting val epoch 27
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0027 / 0050] validation loss: 	0.49462 	0.00000
saving last checkpoint at epoch 27



val  27  mean auc :0.579331 mean auprc 0.279218


 
starting train epoch 27
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0027 / 0050] [0009/484] eta: 0 Days 7:56:26        lr: 	3.8330E-05 loss: 	0.52906 loss align 0.0000
 epoch [0027 / 0050] [0109/484] eta: 0 Days 7:51:13        lr: 	3.8330E-05 loss: 	0.48067 loss align 0.0000
 epoch [0027 / 0050] [0209/484] eta: 0 Days 7:46:1         lr: 	3.8330E-05 loss: 	0.48192 loss align 0.0000
 epoch [0027 / 0050] [0309/484] eta: 0 Days 7:40:52        lr: 	3.8330E-05 loss: 	0.48144 loss align 0.0000
 epoch [0027 / 0050] [0409/484] eta: 0 Days 7:35:44        lr: 	3.8330E-05 loss: 	0.48150 loss align 0.0000
starting val epoch 28
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0028 / 0050] validation loss: 	0.49340 	0.00000
saving last checkpoint at epoch 28
saving best checkpoint at epoch 28
Acute and unspecified renal failure                                                        & 0.614(0.651, 0.571) & 0.454 (0.511, 0.397) 
Acute cerebrovascular disease                                                              & 0.701(0.776, 0.617) & 0.167 (0.259, 0.113) 
Acute myocardial infarction                                                                & 0.505(0.574, 0.441) & 0.087 (0.118, 0.066) 
Cardiac dysrhythmias                                                                       & 0.553(0.591, 0.514) & 0.383 (0.435, 0.341) 
Chronic kidney disease                                                                     & 0.580(0.623, 0.536) & 0.295 (0.352, 0.250) 
Chronic obstructive pulmonary disease and bronchiectasis                                   & 0.575(0.624, 0.530) & 0.250 (0.315, 0.204) 
Complications of surgical procedures or medical care                                       & 0.550(0.598, 0.504) & 0.236 (0.280, 0.203) 
Conduction disorders                                                                       & 0.544(0.604, 0.482) & 0.134 (0.177, 0.104) 
Congestive heart failure; nonhypertensive                                                  & 0.610(0.649, 0.569) & 0.392 (0.450, 0.346) 
Coronary atherosclerosis and other heart disease                                           & 0.570(0.609, 0.530) & 0.373 (0.428, 0.326) 
Diabetes mellitus with complications                                                       & 0.623(0.677, 0.568) & 0.189 (0.250, 0.145) 
Diabetes mellitus without complication                                                     & 0.597(0.641, 0.553) & 0.257 (0.312, 0.215) 
Disorders of lipid metabolism                                                              & 0.549(0.588, 0.511) & 0.480 (0.530, 0.435) 
Essential hypertension                                                                     & 0.501(0.538, 0.460) & 0.440 (0.488, 0.396) 
Fluid and electrolyte disorders                                                            & 0.571(0.610, 0.534) & 0.516 (0.565, 0.463) 
Gastrointestinal hemorrhage                                                                & 0.485(0.560, 0.414) & 0.065 (0.104, 0.047) 
Hypertension with complications and secondary hypertension                                 & 0.528(0.577, 0.483) & 0.225 (0.274, 0.192) 
Other liver diseases                                                                       & 0.590(0.649, 0.532) & 0.218 (0.293, 0.165) 
Other lower respiratory disease                                                            & 0.532(0.591, 0.473) & 0.152 (0.203, 0.119) 
Other upper respiratory disease                                                            & 0.573(0.631, 0.506) & 0.103 (0.145, 0.079) 
Pleurisy; pneumothorax; pulmonary collapse                                                 & 0.586(0.648, 0.526) & 0.152 (0.207, 0.115) 
Pneumonia (except that caused by tuberculosis or sexually transmitted disease)             & 0.644(0.687, 0.604) & 0.290 (0.352, 0.235) 
Respiratory failure; insufficiency; arrest (adult)                                         & 0.679(0.714, 0.639) & 0.453 (0.514, 0.403) 
Septicemia (except in labor)                                                               & 0.628(0.676, 0.583) & 0.324 (0.396, 0.273) 
Shock                                                                                      & 0.644(0.692, 0.594) & 0.367 (0.443, 0.300) 



val  28  best mean auc :0.581 mean auprc 0.280 


                    CI AUROC (0.531, 0.631) CI AUPRC (0.237, 0.336) 


                     AUROC accute 0.593 mixed 0.584 chronic 0.557


                     AUROC accute CI (0.539, 0.647) mixed (0.533 , 0.634) chronic (0.515, 0.600)


                     AUPRC accute  0.259 mixed 0.263 chronic 0.331 


                     AUPRC accute CI  (0.216, 0.315) mixed (0.220,  0.321) chronic (0.288, 0.385) 


                    
starting train epoch 28
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0028 / 0050] [0009/484] eta: 0 Days 7:35:39        lr: 	3.8330E-05 loss: 	0.53982 loss align 0.0000
 epoch [0028 / 0050] [0109/484] eta: 0 Days 7:30:31        lr: 	3.8330E-05 loss: 	0.48851 loss align 0.0000
 epoch [0028 / 0050] [0209/484] eta: 0 Days 7:25:23        lr: 	3.8330E-05 loss: 	0.48138 loss align 0.0000
 epoch [0028 / 0050] [0309/484] eta: 0 Days 7:20:18        lr: 	3.8330E-05 loss: 	0.48234 loss align 0.0000
 epoch [0028 / 0050] [0409/484] eta: 0 Days 7:15:15        lr: 	3.8330E-05 loss: 	0.48339 loss align 0.0000
starting val epoch 29
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0029 / 0050] validation loss: 	0.49382 	0.00000
saving last checkpoint at epoch 29
saving best checkpoint at epoch 29
Acute and unspecified renal failure                                                        & 0.618(0.659, 0.577) & 0.454 (0.514, 0.402) 
Acute cerebrovascular disease                                                              & 0.697(0.773, 0.609) & 0.156 (0.237, 0.106) 
Acute myocardial infarction                                                                & 0.517(0.579, 0.453) & 0.087 (0.115, 0.067) 
Cardiac dysrhythmias                                                                       & 0.555(0.595, 0.515) & 0.385 (0.438, 0.339) 
Chronic kidney disease                                                                     & 0.585(0.628, 0.540) & 0.293 (0.356, 0.249) 
Chronic obstructive pulmonary disease and bronchiectasis                                   & 0.588(0.639, 0.531) & 0.258 (0.321, 0.210) 
Complications of surgical procedures or medical care                                       & 0.543(0.589, 0.497) & 0.233 (0.276, 0.197) 
Conduction disorders                                                                       & 0.531(0.588, 0.468) & 0.132 (0.176, 0.103) 
Congestive heart failure; nonhypertensive                                                  & 0.615(0.650, 0.575) & 0.399 (0.462, 0.348) 
Coronary atherosclerosis and other heart disease                                           & 0.564(0.605, 0.522) & 0.383 (0.441, 0.337) 
Diabetes mellitus with complications                                                       & 0.616(0.676, 0.561) & 0.184 (0.248, 0.146) 
Diabetes mellitus without complication                                                     & 0.606(0.652, 0.562) & 0.262 (0.318, 0.221) 
Disorders of lipid metabolism                                                              & 0.552(0.589, 0.514) & 0.483 (0.537, 0.441) 
Essential hypertension                                                                     & 0.504(0.541, 0.465) & 0.441 (0.491, 0.400) 
Fluid and electrolyte disorders                                                            & 0.573(0.611, 0.533) & 0.517 (0.573, 0.472) 
Gastrointestinal hemorrhage                                                                & 0.520(0.592, 0.455) & 0.069 (0.111, 0.050) 
Hypertension with complications and secondary hypertension                                 & 0.548(0.595, 0.500) & 0.234 (0.286, 0.196) 
Other liver diseases                                                                       & 0.591(0.646, 0.533) & 0.220 (0.294, 0.171) 
Other lower respiratory disease                                                            & 0.524(0.585, 0.462) & 0.150 (0.204, 0.119) 
Other upper respiratory disease                                                            & 0.554(0.612, 0.490) & 0.099 (0.134, 0.075) 
Pleurisy; pneumothorax; pulmonary collapse                                                 & 0.586(0.651, 0.519) & 0.159 (0.218, 0.120) 
Pneumonia (except that caused by tuberculosis or sexually transmitted disease)             & 0.635(0.678, 0.589) & 0.283 (0.348, 0.229) 
Respiratory failure; insufficiency; arrest (adult)                                         & 0.671(0.707, 0.633) & 0.447 (0.507, 0.394) 
Septicemia (except in labor)                                                               & 0.629(0.676, 0.580) & 0.334 (0.400, 0.281) 
Shock                                                                                      & 0.642(0.690, 0.587) & 0.364 (0.438, 0.298) 



val  29  best mean auc :0.582 mean auprc 0.281 


                    CI AUROC (0.531, 0.632) CI AUPRC (0.239, 0.338) 


                     AUROC accute 0.593 mixed 0.581 chronic 0.564


                     AUROC accute CI (0.537, 0.646) mixed (0.530 , 0.631) chronic (0.519, 0.607)


                     AUPRC accute  0.258 mixed 0.264 chronic 0.336 


                     AUPRC accute CI  (0.216, 0.314) mixed (0.222,  0.324) chronic (0.293, 0.393) 


                    
starting train epoch 29
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0029 / 0050] [0009/484] eta: 0 Days 7:14:51        lr: 	3.8330E-05 loss: 	0.51520 loss align 0.0000
 epoch [0029 / 0050] [0109/484] eta: 0 Days 7:9:46         lr: 	3.8330E-05 loss: 	0.48397 loss align 0.0000
 epoch [0029 / 0050] [0209/484] eta: 0 Days 7:4:44         lr: 	3.8330E-05 loss: 	0.48219 loss align 0.0000
 epoch [0029 / 0050] [0309/484] eta: 0 Days 6:59:42        lr: 	3.8330E-05 loss: 	0.48331 loss align 0.0000
 epoch [0029 / 0050] [0409/484] eta: 0 Days 6:54:40        lr: 	3.8330E-05 loss: 	0.48217 loss align 0.0000
starting val epoch 30
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0030 / 0050] validation loss: 	0.49420 	0.00000
saving last checkpoint at epoch 30



val  30  mean auc :0.579151 mean auprc 0.278078


 
starting train epoch 30
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0030 / 0050] [0009/484] eta: 0 Days 6:54:1         lr: 	3.8330E-05 loss: 	0.53988 loss align 0.0000
 epoch [0030 / 0050] [0109/484] eta: 0 Days 6:49:0         lr: 	3.8330E-05 loss: 	0.48762 loss align 0.0000
 epoch [0030 / 0050] [0209/484] eta: 0 Days 6:44:1         lr: 	3.8330E-05 loss: 	0.48369 loss align 0.0000
 epoch [0030 / 0050] [0309/484] eta: 0 Days 6:39:4         lr: 	3.8330E-05 loss: 	0.48324 loss align 0.0000
 epoch [0030 / 0050] [0409/484] eta: 0 Days 6:34:8         lr: 	3.8330E-05 loss: 	0.48178 loss align 0.0000
starting val epoch 31
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0031 / 0050] validation loss: 	0.49346 	0.00000
saving last checkpoint at epoch 31
saving best checkpoint at epoch 31
Acute and unspecified renal failure                                                        & 0.616(0.658, 0.575) & 0.452 (0.517, 0.397) 
Acute cerebrovascular disease                                                              & 0.706(0.788, 0.620) & 0.191 (0.306, 0.123) 
Acute myocardial infarction                                                                & 0.512(0.581, 0.448) & 0.087 (0.114, 0.067) 
Cardiac dysrhythmias                                                                       & 0.554(0.592, 0.511) & 0.381 (0.434, 0.339) 
Chronic kidney disease                                                                     & 0.584(0.628, 0.537) & 0.297 (0.356, 0.253) 
Chronic obstructive pulmonary disease and bronchiectasis                                   & 0.585(0.634, 0.535) & 0.264 (0.329, 0.216) 
Complications of surgical procedures or medical care                                       & 0.547(0.600, 0.500) & 0.235 (0.280, 0.202) 
Conduction disorders                                                                       & 0.523(0.582, 0.461) & 0.127 (0.167, 0.099) 
Congestive heart failure; nonhypertensive                                                  & 0.613(0.652, 0.572) & 0.389 (0.448, 0.339) 
Coronary atherosclerosis and other heart disease                                           & 0.575(0.614, 0.537) & 0.379 (0.441, 0.337) 
Diabetes mellitus with complications                                                       & 0.618(0.672, 0.565) & 0.184 (0.243, 0.143) 
Diabetes mellitus without complication                                                     & 0.599(0.646, 0.555) & 0.256 (0.309, 0.218) 
Disorders of lipid metabolism                                                              & 0.543(0.579, 0.505) & 0.473 (0.522, 0.434) 
Essential hypertension                                                                     & 0.504(0.542, 0.461) & 0.439 (0.489, 0.396) 
Fluid and electrolyte disorders                                                            & 0.572(0.610, 0.536) & 0.518 (0.574, 0.465) 
Gastrointestinal hemorrhage                                                                & 0.497(0.574, 0.427) & 0.066 (0.101, 0.049) 
Hypertension with complications and secondary hypertension                                 & 0.539(0.586, 0.493) & 0.226 (0.275, 0.189) 
Other liver diseases                                                                       & 0.592(0.647, 0.533) & 0.224 (0.300, 0.171) 
Other lower respiratory disease                                                            & 0.544(0.602, 0.486) & 0.153 (0.203, 0.118) 
Other upper respiratory disease                                                            & 0.565(0.627, 0.510) & 0.100 (0.138, 0.078) 
Pleurisy; pneumothorax; pulmonary collapse                                                 & 0.595(0.655, 0.530) & 0.159 (0.219, 0.121) 
Pneumonia (except that caused by tuberculosis or sexually transmitted disease)             & 0.644(0.684, 0.603) & 0.285 (0.351, 0.235) 
Respiratory failure; insufficiency; arrest (adult)                                         & 0.676(0.712, 0.638) & 0.451 (0.515, 0.400) 
Septicemia (except in labor)                                                               & 0.625(0.672, 0.578) & 0.317 (0.384, 0.265) 
Shock                                                                                      & 0.639(0.687, 0.596) & 0.367 (0.446, 0.306) 



val  31  best mean auc :0.583 mean auprc 0.281 


                    CI AUROC (0.533, 0.633) CI AUPRC (0.238, 0.338) 


                     AUROC accute 0.595 mixed 0.580 chronic 0.561


                     AUROC accute CI (0.542, 0.650) mixed (0.528 , 0.629) chronic (0.518, 0.604)


                     AUPRC accute  0.260 mixed 0.261 chronic 0.333 


                     AUPRC accute CI  (0.217, 0.319) mixed (0.218,  0.318) chronic (0.292, 0.389) 


                    
starting train epoch 31
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0031 / 0050] [0009/484] eta: 0 Days 6:33:15        lr: 	3.8330E-05 loss: 	0.53071 loss align 0.0000
 epoch [0031 / 0050] [0109/484] eta: 0 Days 6:28:18        lr: 	3.8330E-05 loss: 	0.48282 loss align 0.0000
 epoch [0031 / 0050] [0209/484] eta: 0 Days 6:23:23        lr: 	3.8330E-05 loss: 	0.47938 loss align 0.0000
 epoch [0031 / 0050] [0309/484] eta: 0 Days 6:18:28        lr: 	3.8330E-05 loss: 	0.48029 loss align 0.0000
 epoch [0031 / 0050] [0409/484] eta: 0 Days 6:13:36        lr: 	3.8330E-05 loss: 	0.48138 loss align 0.0000
starting val epoch 32
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0032 / 0050] validation loss: 	0.49383 	0.00000
saving last checkpoint at epoch 32



val  32  mean auc :0.581152 mean auprc 0.280404


 
starting train epoch 32
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0032 / 0050] [0009/484] eta: 0 Days 6:12:28        lr: 	3.8330E-05 loss: 	0.54141 loss align 0.0000
 epoch [0032 / 0050] [0109/484] eta: 0 Days 6:7:35         lr: 	3.8330E-05 loss: 	0.48087 loss align 0.0000
 epoch [0032 / 0050] [0209/484] eta: 0 Days 6:2:43         lr: 	3.8330E-05 loss: 	0.48264 loss align 0.0000
 epoch [0032 / 0050] [0309/484] eta: 0 Days 5:57:51        lr: 	3.8330E-05 loss: 	0.48154 loss align 0.0000
 epoch [0032 / 0050] [0409/484] eta: 0 Days 5:53:2         lr: 	3.8330E-05 loss: 	0.48181 loss align 0.0000
starting val epoch 33
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0033 / 0050] validation loss: 	0.49292 	0.00000
saving last checkpoint at epoch 33
saving best checkpoint at epoch 33
Acute and unspecified renal failure                                                        & 0.618(0.659, 0.579) & 0.444 (0.509, 0.392) 
Acute cerebrovascular disease                                                              & 0.699(0.779, 0.613) & 0.181 (0.287, 0.118) 
Acute myocardial infarction                                                                & 0.520(0.585, 0.457) & 0.087 (0.116, 0.069) 
Cardiac dysrhythmias                                                                       & 0.556(0.596, 0.514) & 0.385 (0.436, 0.341) 
Chronic kidney disease                                                                     & 0.576(0.618, 0.532) & 0.286 (0.341, 0.241) 
Chronic obstructive pulmonary disease and bronchiectasis                                   & 0.587(0.637, 0.536) & 0.263 (0.329, 0.215) 
Complications of surgical procedures or medical care                                       & 0.541(0.588, 0.492) & 0.233 (0.279, 0.198) 
Conduction disorders                                                                       & 0.533(0.593, 0.473) & 0.131 (0.177, 0.105) 
Congestive heart failure; nonhypertensive                                                  & 0.618(0.655, 0.578) & 0.394 (0.454, 0.348) 
Coronary atherosclerosis and other heart disease                                           & 0.574(0.615, 0.535) & 0.384 (0.439, 0.337) 
Diabetes mellitus with complications                                                       & 0.619(0.673, 0.565) & 0.186 (0.251, 0.147) 
Diabetes mellitus without complication                                                     & 0.610(0.657, 0.566) & 0.263 (0.321, 0.223) 
Disorders of lipid metabolism                                                              & 0.551(0.590, 0.513) & 0.479 (0.531, 0.437) 
Essential hypertension                                                                     & 0.501(0.538, 0.463) & 0.433 (0.483, 0.393) 
Fluid and electrolyte disorders                                                            & 0.574(0.611, 0.537) & 0.521 (0.575, 0.472) 
Gastrointestinal hemorrhage                                                                & 0.515(0.589, 0.440) & 0.069 (0.110, 0.050) 
Hypertension with complications and secondary hypertension                                 & 0.543(0.589, 0.502) & 0.228 (0.276, 0.197) 
Other liver diseases                                                                       & 0.596(0.653, 0.543) & 0.223 (0.295, 0.173) 
Other lower respiratory disease                                                            & 0.542(0.600, 0.480) & 0.153 (0.203, 0.119) 
Other upper respiratory disease                                                            & 0.555(0.621, 0.497) & 0.099 (0.138, 0.077) 
Pleurisy; pneumothorax; pulmonary collapse                                                 & 0.588(0.654, 0.530) & 0.161 (0.226, 0.126) 
Pneumonia (except that caused by tuberculosis or sexually transmitted disease)             & 0.642(0.687, 0.598) & 0.285 (0.346, 0.237) 
Respiratory failure; insufficiency; arrest (adult)                                         & 0.673(0.710, 0.636) & 0.450 (0.511, 0.398) 
Septicemia (except in labor)                                                               & 0.628(0.675, 0.579) & 0.331 (0.400, 0.277) 
Shock                                                                                      & 0.642(0.691, 0.594) & 0.368 (0.456, 0.300) 



val  33  best mean auc :0.584 mean auprc 0.282 


                    CI AUROC (0.534, 0.635) CI AUPRC (0.240, 0.340) 


                     AUROC accute 0.595 mixed 0.584 chronic 0.563


                     AUROC accute CI (0.541, 0.650) mixed (0.535 , 0.634) chronic (0.521, 0.606)


                     AUPRC accute  0.260 mixed 0.264 chronic 0.334 


                     AUPRC accute CI  (0.218, 0.320) mixed (0.223,  0.323) chronic (0.292, 0.389) 


                    
starting train epoch 33
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0033 / 0050] [0009/484] eta: 0 Days 5:51:43        lr: 	3.8330E-05 loss: 	0.54842 loss align 0.0000
 epoch [0033 / 0050] [0109/484] eta: 0 Days 5:46:53        lr: 	3.8330E-05 loss: 	0.48784 loss align 0.0000
 epoch [0033 / 0050] [0209/484] eta: 0 Days 5:42:5         lr: 	3.8330E-05 loss: 	0.48368 loss align 0.0000
 epoch [0033 / 0050] [0309/484] eta: 0 Days 5:37:16        lr: 	3.8330E-05 loss: 	0.48125 loss align 0.0000
 epoch [0033 / 0050] [0409/484] eta: 0 Days 5:32:29        lr: 	3.8330E-05 loss: 	0.48075 loss align 0.0000
starting val epoch 34
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0034 / 0050] validation loss: 	0.49310 	0.00000
saving last checkpoint at epoch 34



val  34  mean auc :0.582269 mean auprc 0.281424


 
starting train epoch 34
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0034 / 0050] [0009/484] eta: 0 Days 5:30:58        lr: 	3.8330E-05 loss: 	0.52711 loss align 0.0000
 epoch [0034 / 0050] [0109/484] eta: 0 Days 5:26:11        lr: 	3.8330E-05 loss: 	0.48653 loss align 0.0000
 epoch [0034 / 0050] [0209/484] eta: 0 Days 5:21:25        lr: 	3.8330E-05 loss: 	0.48455 loss align 0.0000
 epoch [0034 / 0050] [0309/484] eta: 0 Days 5:16:40        lr: 	3.8330E-05 loss: 	0.48299 loss align 0.0000
 epoch [0034 / 0050] [0409/484] eta: 0 Days 5:11:56        lr: 	3.8330E-05 loss: 	0.48204 loss align 0.0000
starting val epoch 35
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0035 / 0050] validation loss: 	0.49306 	0.00000
saving last checkpoint at epoch 35
saving best checkpoint at epoch 35
Acute and unspecified renal failure                                                        & 0.619(0.661, 0.577) & 0.457 (0.519, 0.401) 
Acute cerebrovascular disease                                                              & 0.711(0.791, 0.628) & 0.195 (0.315, 0.122) 
Acute myocardial infarction                                                                & 0.537(0.594, 0.475) & 0.091 (0.123, 0.071) 
Cardiac dysrhythmias                                                                       & 0.556(0.599, 0.513) & 0.384 (0.437, 0.338) 
Chronic kidney disease                                                                     & 0.594(0.638, 0.554) & 0.305 (0.365, 0.257) 
Chronic obstructive pulmonary disease and bronchiectasis                                   & 0.585(0.635, 0.533) & 0.263 (0.327, 0.215) 
Complications of surgical procedures or medical care                                       & 0.542(0.590, 0.495) & 0.233 (0.278, 0.200) 
Conduction disorders                                                                       & 0.552(0.605, 0.492) & 0.138 (0.180, 0.111) 
Congestive heart failure; nonhypertensive                                                  & 0.618(0.656, 0.579) & 0.404 (0.464, 0.357) 
Coronary atherosclerosis and other heart disease                                           & 0.581(0.618, 0.540) & 0.378 (0.432, 0.335) 
Diabetes mellitus with complications                                                       & 0.627(0.679, 0.572) & 0.188 (0.248, 0.147) 
Diabetes mellitus without complication                                                     & 0.609(0.653, 0.561) & 0.264 (0.322, 0.223) 
Disorders of lipid metabolism                                                              & 0.553(0.594, 0.515) & 0.482 (0.529, 0.439) 
Essential hypertension                                                                     & 0.504(0.543, 0.467) & 0.436 (0.483, 0.397) 
Fluid and electrolyte disorders                                                            & 0.573(0.610, 0.535) & 0.518 (0.570, 0.470) 
Gastrointestinal hemorrhage                                                                & 0.513(0.593, 0.438) & 0.069 (0.107, 0.051) 
Hypertension with complications and secondary hypertension                                 & 0.554(0.602, 0.510) & 0.238 (0.295, 0.198) 
Other liver diseases                                                                       & 0.591(0.647, 0.541) & 0.221 (0.296, 0.171) 
Other lower respiratory disease                                                            & 0.523(0.581, 0.461) & 0.160 (0.216, 0.123) 
Other upper respiratory disease                                                            & 0.555(0.616, 0.486) & 0.099 (0.135, 0.075) 
Pleurisy; pneumothorax; pulmonary collapse                                                 & 0.582(0.644, 0.521) & 0.158 (0.219, 0.119) 
Pneumonia (except that caused by tuberculosis or sexually transmitted disease)             & 0.645(0.688, 0.601) & 0.286 (0.352, 0.234) 
Respiratory failure; insufficiency; arrest (adult)                                         & 0.680(0.717, 0.642) & 0.454 (0.516, 0.399) 
Septicemia (except in labor)                                                               & 0.633(0.680, 0.586) & 0.334 (0.405, 0.278) 
Shock                                                                                      & 0.648(0.694, 0.600) & 0.374 (0.447, 0.303) 



val  35  best mean auc :0.587 mean auprc 0.285 


                    CI AUROC (0.537, 0.637) CI AUPRC (0.241, 0.343) 


                     AUROC accute 0.597 mixed 0.589 chronic 0.569


                     AUROC accute CI (0.542, 0.651) mixed (0.540 , 0.637) chronic (0.526, 0.612)


                     AUPRC accute  0.264 mixed 0.267 chronic 0.338 


                     AUPRC accute CI  (0.219, 0.323) mixed (0.225,  0.325) chronic (0.295, 0.393) 


                    
starting train epoch 35
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0035 / 0050] [0009/484] eta: 0 Days 5:10:15        lr: 	3.8330E-05 loss: 	0.51036 loss align 0.0000
 epoch [0035 / 0050] [0109/484] eta: 0 Days 5:5:30         lr: 	3.8330E-05 loss: 	0.48390 loss align 0.0000
 epoch [0035 / 0050] [0209/484] eta: 0 Days 5:0:47         lr: 	3.8330E-05 loss: 	0.48133 loss align 0.0000
 epoch [0035 / 0050] [0309/484] eta: 0 Days 4:56:4         lr: 	3.8330E-05 loss: 	0.48056 loss align 0.0000
 epoch [0035 / 0050] [0409/484] eta: 0 Days 4:51:23        lr: 	3.8330E-05 loss: 	0.48075 loss align 0.0000
starting val epoch 36
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0036 / 0050] validation loss: 	0.49321 	0.00000
saving last checkpoint at epoch 36



val  36  mean auc :0.582321 mean auprc 0.282664


 
starting train epoch 36
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0036 / 0050] [0009/484] eta: 0 Days 4:49:29        lr: 	3.8330E-05 loss: 	0.55140 loss align 0.0000
 epoch [0036 / 0050] [0109/484] eta: 0 Days 4:44:47        lr: 	3.8330E-05 loss: 	0.48444 loss align 0.0000
 epoch [0036 / 0050] [0209/484] eta: 0 Days 4:40:6         lr: 	3.8330E-05 loss: 	0.48158 loss align 0.0000
 epoch [0036 / 0050] [0309/484] eta: 0 Days 4:35:26        lr: 	3.8330E-05 loss: 	0.47970 loss align 0.0000
 epoch [0036 / 0050] [0409/484] eta: 0 Days 4:30:48        lr: 	3.8330E-05 loss: 	0.48004 loss align 0.0000
starting val epoch 37
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0037 / 0050] validation loss: 	0.49361 	0.00000
saving last checkpoint at epoch 37



val  37  mean auc :0.585085 mean auprc 0.281498


 
starting train epoch 37
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0037 / 0050] [0009/484] eta: 0 Days 4:28:45        lr: 	3.8330E-05 loss: 	0.53384 loss align 0.0000
 epoch [0037 / 0050] [0109/484] eta: 0 Days 4:24:6         lr: 	3.8330E-05 loss: 	0.48864 loss align 0.0000
 epoch [0037 / 0050] [0209/484] eta: 0 Days 4:19:27        lr: 	3.8330E-05 loss: 	0.48375 loss align 0.0000
 epoch [0037 / 0050] [0309/484] eta: 0 Days 4:14:49        lr: 	3.8330E-05 loss: 	0.48162 loss align 0.0000
 epoch [0037 / 0050] [0409/484] eta: 0 Days 4:10:12        lr: 	3.8330E-05 loss: 	0.48203 loss align 0.0000
starting val epoch 38
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0038 / 0050] validation loss: 	0.49245 	0.00000
saving last checkpoint at epoch 38



val  38  mean auc :0.585817 mean auprc 0.284259


 
starting train epoch 38
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0038 / 0050] [0009/484] eta: 0 Days 4:7:59         lr: 	3.8330E-05 loss: 	0.55635 loss align 0.0000
 epoch [0038 / 0050] [0109/484] eta: 0 Days 4:3:22         lr: 	3.8330E-05 loss: 	0.48512 loss align 0.0000
 epoch [0038 / 0050] [0209/484] eta: 0 Days 3:58:46        lr: 	3.8330E-05 loss: 	0.48382 loss align 0.0000
 epoch [0038 / 0050] [0309/484] eta: 0 Days 3:54:11        lr: 	3.8330E-05 loss: 	0.48428 loss align 0.0000
 epoch [0038 / 0050] [0409/484] eta: 0 Days 3:49:36        lr: 	3.8330E-05 loss: 	0.48227 loss align 0.0000
starting val epoch 39
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0039 / 0050] validation loss: 	0.49228 	0.00000
saving last checkpoint at epoch 39



val  39  mean auc :0.587080 mean auprc 0.284531


 
starting train epoch 39
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0039 / 0050] [0009/484] eta: 0 Days 3:47:15        lr: 	3.8330E-05 loss: 	0.52279 loss align 0.0000
 epoch [0039 / 0050] [0109/484] eta: 0 Days 3:42:40        lr: 	3.8330E-05 loss: 	0.48206 loss align 0.0000
 epoch [0039 / 0050] [0209/484] eta: 0 Days 3:38:6         lr: 	3.8330E-05 loss: 	0.47897 loss align 0.0000
 epoch [0039 / 0050] [0309/484] eta: 0 Days 3:33:33        lr: 	3.8330E-05 loss: 	0.47886 loss align 0.0000
 epoch [0039 / 0050] [0409/484] eta: 0 Days 3:29:1         lr: 	3.8330E-05 loss: 	0.47995 loss align 0.0000
starting val epoch 40
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0040 / 0050] validation loss: 	0.49275 	0.00000
saving last checkpoint at epoch 40



val  40  mean auc :0.584208 mean auprc 0.281428


 
starting train epoch 40
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0040 / 0050] [0009/484] eta: 0 Days 3:26:32        lr: 	3.8330E-05 loss: 	0.54810 loss align 0.0000
 epoch [0040 / 0050] [0109/484] eta: 0 Days 3:21:59        lr: 	3.8330E-05 loss: 	0.48922 loss align 0.0000
 epoch [0040 / 0050] [0209/484] eta: 0 Days 3:17:28        lr: 	3.8330E-05 loss: 	0.48182 loss align 0.0000
 epoch [0040 / 0050] [0309/484] eta: 0 Days 3:12:57        lr: 	3.8330E-05 loss: 	0.48177 loss align 0.0000
 epoch [0040 / 0050] [0409/484] eta: 0 Days 3:8:26         lr: 	3.8330E-05 loss: 	0.48098 loss align 0.0000
starting val epoch 41
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0041 / 0050] validation loss: 	0.49238 	0.00000
saving last checkpoint at epoch 41



val  41  mean auc :0.584780 mean auprc 0.282432


 
starting train epoch 41
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0041 / 0050] [0009/484] eta: 0 Days 3:5:49         lr: 	3.8330E-05 loss: 	0.52548 loss align 0.0000
 epoch [0041 / 0050] [0109/484] eta: 0 Days 3:1:18         lr: 	3.8330E-05 loss: 	0.47751 loss align 0.0000
 epoch [0041 / 0050] [0209/484] eta: 0 Days 2:56:49        lr: 	3.8330E-05 loss: 	0.47795 loss align 0.0000
 epoch [0041 / 0050] [0309/484] eta: 0 Days 2:52:20        lr: 	3.8330E-05 loss: 	0.47829 loss align 0.0000
 epoch [0041 / 0050] [0409/484] eta: 0 Days 2:47:52        lr: 	3.8330E-05 loss: 	0.47939 loss align 0.0000
starting val epoch 42
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0042 / 0050] validation loss: 	0.49205 	0.00000
saving last checkpoint at epoch 42



val  42  mean auc :0.586163 mean auprc 0.284300


 
starting train epoch 42
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0042 / 0050] [0009/484] eta: 0 Days 2:45:7         lr: 	3.8330E-05 loss: 	0.52692 loss align 0.0000
 epoch [0042 / 0050] [0109/484] eta: 0 Days 2:40:38        lr: 	3.8330E-05 loss: 	0.48274 loss align 0.0000
 epoch [0042 / 0050] [0209/484] eta: 0 Days 2:36:10        lr: 	3.8330E-05 loss: 	0.48241 loss align 0.0000
 epoch [0042 / 0050] [0309/484] eta: 0 Days 2:31:43        lr: 	3.8330E-05 loss: 	0.48086 loss align 0.0000
 epoch [0042 / 0050] [0409/484] eta: 0 Days 2:27:17        lr: 	3.8330E-05 loss: 	0.48053 loss align 0.0000
starting val epoch 43
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0043 / 0050] validation loss: 	0.49172 	0.00000
saving last checkpoint at epoch 43



val  43  mean auc :0.587185 mean auprc 0.286130


 
starting train epoch 43
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0043 / 0050] [0009/484] eta: 0 Days 2:24:25        lr: 	3.8330E-05 loss: 	0.53969 loss align 0.0000
 epoch [0043 / 0050] [0109/484] eta: 0 Days 2:19:58        lr: 	3.8330E-05 loss: 	0.48252 loss align 0.0000
 epoch [0043 / 0050] [0209/484] eta: 0 Days 2:15:32        lr: 	3.8330E-05 loss: 	0.48035 loss align 0.0000
 epoch [0043 / 0050] [0309/484] eta: 0 Days 2:11:6         lr: 	3.8330E-05 loss: 	0.47974 loss align 0.0000
 epoch [0043 / 0050] [0409/484] eta: 0 Days 2:6:42         lr: 	3.8330E-05 loss: 	0.47978 loss align 0.0000
starting val epoch 44
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0044 / 0050] validation loss: 	0.49219 	0.00000
saving last checkpoint at epoch 44
saving best checkpoint at epoch 44
Acute and unspecified renal failure                                                        & 0.624(0.663, 0.583) & 0.456 (0.518, 0.403) 
Acute cerebrovascular disease                                                              & 0.709(0.786, 0.627) & 0.189 (0.289, 0.126) 
Acute myocardial infarction                                                                & 0.539(0.603, 0.478) & 0.095 (0.128, 0.073) 
Cardiac dysrhythmias                                                                       & 0.554(0.594, 0.516) & 0.380 (0.431, 0.335) 
Chronic kidney disease                                                                     & 0.588(0.630, 0.541) & 0.299 (0.359, 0.249) 
Chronic obstructive pulmonary disease and bronchiectasis                                   & 0.592(0.641, 0.543) & 0.263 (0.332, 0.215) 
Complications of surgical procedures or medical care                                       & 0.543(0.589, 0.495) & 0.234 (0.277, 0.198) 
Conduction disorders                                                                       & 0.541(0.598, 0.481) & 0.137 (0.185, 0.107) 
Congestive heart failure; nonhypertensive                                                  & 0.618(0.658, 0.578) & 0.400 (0.458, 0.355) 
Coronary atherosclerosis and other heart disease                                           & 0.581(0.620, 0.545) & 0.386 (0.444, 0.342) 
Diabetes mellitus with complications                                                       & 0.631(0.683, 0.576) & 0.191 (0.250, 0.148) 
Diabetes mellitus without complication                                                     & 0.613(0.658, 0.568) & 0.266 (0.325, 0.225) 
Disorders of lipid metabolism                                                              & 0.556(0.591, 0.519) & 0.482 (0.532, 0.441) 
Essential hypertension                                                                     & 0.505(0.542, 0.466) & 0.435 (0.481, 0.392) 
Fluid and electrolyte disorders                                                            & 0.573(0.610, 0.535) & 0.517 (0.570, 0.467) 
Gastrointestinal hemorrhage                                                                & 0.511(0.587, 0.435) & 0.067 (0.102, 0.050) 
Hypertension with complications and secondary hypertension                                 & 0.554(0.599, 0.508) & 0.239 (0.292, 0.203) 
Other liver diseases                                                                       & 0.596(0.651, 0.537) & 0.224 (0.298, 0.171) 
Other lower respiratory disease                                                            & 0.525(0.584, 0.465) & 0.151 (0.206, 0.118) 
Other upper respiratory disease                                                            & 0.550(0.613, 0.487) & 0.098 (0.134, 0.076) 
Pleurisy; pneumothorax; pulmonary collapse                                                 & 0.596(0.654, 0.534) & 0.162 (0.226, 0.125) 
Pneumonia (except that caused by tuberculosis or sexually transmitted disease)             & 0.647(0.688, 0.604) & 0.289 (0.352, 0.237) 
Respiratory failure; insufficiency; arrest (adult)                                         & 0.678(0.715, 0.642) & 0.455 (0.518, 0.405) 
Septicemia (except in labor)                                                               & 0.632(0.679, 0.587) & 0.325 (0.395, 0.272) 
Shock                                                                                      & 0.643(0.691, 0.594) & 0.376 (0.444, 0.307) 



val  44  best mean auc :0.588 mean auprc 0.285 


                    CI AUROC (0.538, 0.637) CI AUPRC (0.242, 0.342) 


                     AUROC accute 0.598 mixed 0.588 chronic 0.570


                     AUROC accute CI (0.544, 0.651) mixed (0.537 , 0.637) chronic (0.527, 0.612)


                     AUPRC accute  0.262 mixed 0.266 chronic 0.339 


                     AUPRC accute CI  (0.220, 0.320) mixed (0.223,  0.325) chronic (0.295, 0.395) 


                    
starting train epoch 44
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0044 / 0050] [0009/484] eta: 0 Days 2:3:43         lr: 	3.8330E-05 loss: 	0.52136 loss align 0.0000
 epoch [0044 / 0050] [0109/484] eta: 0 Days 1:59:18        lr: 	3.8330E-05 loss: 	0.48304 loss align 0.0000
 epoch [0044 / 0050] [0209/484] eta: 0 Days 1:54:53        lr: 	3.8330E-05 loss: 	0.48140 loss align 0.0000
 epoch [0044 / 0050] [0309/484] eta: 0 Days 1:50:30        lr: 	3.8330E-05 loss: 	0.47813 loss align 0.0000
 epoch [0044 / 0050] [0409/484] eta: 0 Days 1:46:6         lr: 	3.8330E-05 loss: 	0.47986 loss align 0.0000
starting val epoch 45
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0045 / 0050] validation loss: 	0.49198 	0.00000
saving last checkpoint at epoch 45



val  45  mean auc :0.585814 mean auprc 0.285669


 
starting train epoch 45
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0045 / 0050] [0009/484] eta: 0 Days 1:43:1         lr: 	3.8330E-05 loss: 	0.51695 loss align 0.0000
 epoch [0045 / 0050] [0109/484] eta: 0 Days 1:38:37        lr: 	3.8330E-05 loss: 	0.48051 loss align 0.0000
 epoch [0045 / 0050] [0209/484] eta: 0 Days 1:34:14        lr: 	3.8330E-05 loss: 	0.48117 loss align 0.0000
 epoch [0045 / 0050] [0309/484] eta: 0 Days 1:29:52        lr: 	3.8330E-05 loss: 	0.47954 loss align 0.0000
 epoch [0045 / 0050] [0409/484] eta: 0 Days 1:25:30        lr: 	3.8330E-05 loss: 	0.48005 loss align 0.0000
starting val epoch 46
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0046 / 0050] validation loss: 	0.49170 	0.00000
saving last checkpoint at epoch 46



val  46  mean auc :0.586156 mean auprc 0.284273


 
starting train epoch 46
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0046 / 0050] [0009/484] eta: 0 Days 1:22:18        lr: 	3.8330E-05 loss: 	0.52772 loss align 0.0000
 epoch [0046 / 0050] [0109/484] eta: 0 Days 1:17:57        lr: 	3.8330E-05 loss: 	0.48740 loss align 0.0000
 epoch [0046 / 0050] [0209/484] eta: 0 Days 1:13:35        lr: 	3.8330E-05 loss: 	0.48331 loss align 0.0000
 epoch [0046 / 0050] [0309/484] eta: 0 Days 1:9:15         lr: 	3.8330E-05 loss: 	0.48128 loss align 0.0000
 epoch [0046 / 0050] [0409/484] eta: 0 Days 1:4:55         lr: 	3.8330E-05 loss: 	0.48145 loss align 0.0000
starting val epoch 47
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0047 / 0050] validation loss: 	0.49251 	0.00000
saving last checkpoint at epoch 47



val  47  mean auc :0.586147 mean auprc 0.283209


 
starting train epoch 47
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0047 / 0050] [0009/484] eta: 0 Days 1:1:37         lr: 	3.8330E-05 loss: 	0.54426 loss align 0.0000
 epoch [0047 / 0050] [0109/484] eta: 0 Days 0:57:16        lr: 	3.8330E-05 loss: 	0.48388 loss align 0.0000
 epoch [0047 / 0050] [0209/484] eta: 0 Days 0:52:57        lr: 	3.8330E-05 loss: 	0.48272 loss align 0.0000
 epoch [0047 / 0050] [0309/484] eta: 0 Days 0:48:38        lr: 	3.8330E-05 loss: 	0.48072 loss align 0.0000
 epoch [0047 / 0050] [0409/484] eta: 0 Days 0:44:19        lr: 	3.8330E-05 loss: 	0.48004 loss align 0.0000
starting val epoch 48
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0048 / 0050] validation loss: 	0.49185 	0.00000
saving last checkpoint at epoch 48



val  48  mean auc :0.587209 mean auprc 0.284771


 
starting train epoch 48
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0048 / 0050] [0009/484] eta: 0 Days 0:40:56        lr: 	3.8330E-05 loss: 	0.50766 loss align 0.0000
 epoch [0048 / 0050] [0109/484] eta: 0 Days 0:36:37        lr: 	3.8330E-05 loss: 	0.48451 loss align 0.0000
 epoch [0048 / 0050] [0209/484] eta: 0 Days 0:32:19        lr: 	3.8330E-05 loss: 	0.48081 loss align 0.0000
 epoch [0048 / 0050] [0309/484] eta: 0 Days 0:28:1         lr: 	3.8330E-05 loss: 	0.47911 loss align 0.0000
 epoch [0048 / 0050] [0409/484] eta: 0 Days 0:23:44        lr: 	3.8330E-05 loss: 	0.47979 loss align 0.0000
starting val epoch 49
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
val [0049 / 0050] validation loss: 	0.49205 	0.00000
saving last checkpoint at epoch 49
saving best checkpoint at epoch 49
Acute and unspecified renal failure                                                        & 0.632(0.674, 0.593) & 0.459 (0.521, 0.404) 
Acute cerebrovascular disease                                                              & 0.712(0.791, 0.633) & 0.202 (0.321, 0.131) 
Acute myocardial infarction                                                                & 0.548(0.611, 0.483) & 0.095 (0.129, 0.074) 
Cardiac dysrhythmias                                                                       & 0.558(0.595, 0.516) & 0.382 (0.433, 0.337) 
Chronic kidney disease                                                                     & 0.598(0.642, 0.551) & 0.302 (0.361, 0.253) 
Chronic obstructive pulmonary disease and bronchiectasis                                   & 0.591(0.640, 0.543) & 0.261 (0.333, 0.212) 
Complications of surgical procedures or medical care                                       & 0.545(0.591, 0.498) & 0.234 (0.278, 0.199) 
Conduction disorders                                                                       & 0.525(0.591, 0.470) & 0.139 (0.191, 0.108) 
Congestive heart failure; nonhypertensive                                                  & 0.625(0.664, 0.587) & 0.401 (0.466, 0.351) 
Coronary atherosclerosis and other heart disease                                           & 0.578(0.619, 0.537) & 0.384 (0.440, 0.338) 
Diabetes mellitus with complications                                                       & 0.626(0.679, 0.569) & 0.190 (0.252, 0.147) 
Diabetes mellitus without complication                                                     & 0.612(0.657, 0.570) & 0.266 (0.324, 0.221) 
Disorders of lipid metabolism                                                              & 0.554(0.592, 0.517) & 0.479 (0.529, 0.438) 
Essential hypertension                                                                     & 0.504(0.543, 0.465) & 0.435 (0.482, 0.394) 
Fluid and electrolyte disorders                                                            & 0.578(0.618, 0.541) & 0.526 (0.577, 0.478) 
Gastrointestinal hemorrhage                                                                & 0.506(0.583, 0.436) & 0.065 (0.100, 0.049) 
Hypertension with complications and secondary hypertension                                 & 0.561(0.606, 0.513) & 0.243 (0.296, 0.205) 
Other liver diseases                                                                       & 0.599(0.657, 0.542) & 0.223 (0.298, 0.172) 
Other lower respiratory disease                                                            & 0.532(0.597, 0.474) & 0.153 (0.211, 0.119) 
Other upper respiratory disease                                                            & 0.544(0.611, 0.483) & 0.097 (0.137, 0.074) 
Pleurisy; pneumothorax; pulmonary collapse                                                 & 0.595(0.654, 0.535) & 0.164 (0.226, 0.124) 
Pneumonia (except that caused by tuberculosis or sexually transmitted disease)             & 0.646(0.687, 0.602) & 0.286 (0.346, 0.233) 
Respiratory failure; insufficiency; arrest (adult)                                         & 0.674(0.715, 0.634) & 0.452 (0.513, 0.399) 
Septicemia (except in labor)                                                               & 0.637(0.686, 0.590) & 0.326 (0.396, 0.274) 
Shock                                                                                      & 0.642(0.688, 0.593) & 0.373 (0.448, 0.306) 



val  49  best mean auc :0.589 mean auprc 0.285 


                    CI AUROC (0.539, 0.640) CI AUPRC (0.242, 0.344) 


                     AUROC accute 0.599 mixed 0.587 chronic 0.571


                     AUROC accute CI (0.546, 0.654) mixed (0.537 , 0.637) chronic (0.528, 0.614)


                     AUPRC accute  0.264 mixed 0.267 chronic 0.339 


                     AUPRC accute CI  (0.220, 0.323) mixed (0.223,  0.328) chronic (0.294, 0.395) 


                    
starting train epoch 49
/u/langzhou/.conda/envs/medfuse/lib/python3.6/site-packages/torch/utils/data/dataloader.py:481: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
 epoch [0049 / 0050] [0009/484] eta: 0 Days 0:20:15        lr: 	3.8330E-05 loss: 	0.53712 loss align 0.0000
 epoch [0049 / 0050] [0109/484] eta: 0 Days 0:15:57        lr: 	3.8330E-05 loss: 	0.48506 loss align 0.0000
 epoch [0049 / 0050] [0209/484] eta: 0 Days 0:11:40        lr: 	3.8330E-05 loss: 	0.48394 loss align 0.0000
 epoch [0049 / 0050] [0309/484] eta: 0 Days 0:7:24         lr: 	3.8330E-05 loss: 	0.48109 loss align 0.0000
 epoch [0049 / 0050] [0409/484] eta: 0 Days 0:3:8          lr: 	3.8330E-05 loss: 	0.48081 loss align 0.0000
Acute and unspecified renal failure                                                        & 0.632(0.674, 0.593) & 0.459 (0.521, 0.404) 
Acute cerebrovascular disease                                                              & 0.712(0.791, 0.633) & 0.202 (0.321, 0.131) 
Acute myocardial infarction                                                                & 0.548(0.611, 0.483) & 0.095 (0.129, 0.074) 
Cardiac dysrhythmias                                                                       & 0.558(0.595, 0.516) & 0.382 (0.433, 0.337) 
Chronic kidney disease                                                                     & 0.598(0.642, 0.551) & 0.302 (0.361, 0.253) 
Chronic obstructive pulmonary disease and bronchiectasis                                   & 0.591(0.640, 0.543) & 0.261 (0.333, 0.212) 
Complications of surgical procedures or medical care                                       & 0.545(0.591, 0.498) & 0.234 (0.278, 0.199) 
Conduction disorders                                                                       & 0.525(0.591, 0.470) & 0.139 (0.191, 0.108) 
Congestive heart failure; nonhypertensive                                                  & 0.625(0.664, 0.587) & 0.401 (0.466, 0.351) 
Coronary atherosclerosis and other heart disease                                           & 0.578(0.619, 0.537) & 0.384 (0.440, 0.338) 
Diabetes mellitus with complications                                                       & 0.626(0.679, 0.569) & 0.190 (0.252, 0.147) 
Diabetes mellitus without complication                                                     & 0.612(0.657, 0.570) & 0.266 (0.324, 0.221) 
Disorders of lipid metabolism                                                              & 0.554(0.592, 0.517) & 0.479 (0.529, 0.438) 
Essential hypertension                                                                     & 0.504(0.543, 0.465) & 0.435 (0.482, 0.394) 
Fluid and electrolyte disorders                                                            & 0.578(0.618, 0.541) & 0.526 (0.577, 0.478) 
Gastrointestinal hemorrhage                                                                & 0.506(0.583, 0.436) & 0.065 (0.100, 0.049) 
Hypertension with complications and secondary hypertension                                 & 0.561(0.606, 0.513) & 0.243 (0.296, 0.205) 
Other liver diseases                                                                       & 0.599(0.657, 0.542) & 0.223 (0.298, 0.172) 
Other lower respiratory disease                                                            & 0.532(0.597, 0.474) & 0.153 (0.211, 0.119) 
Other upper respiratory disease                                                            & 0.544(0.611, 0.483) & 0.097 (0.137, 0.074) 
Pleurisy; pneumothorax; pulmonary collapse                                                 & 0.595(0.654, 0.535) & 0.164 (0.226, 0.124) 
Pneumonia (except that caused by tuberculosis or sexually transmitted disease)             & 0.646(0.687, 0.602) & 0.286 (0.346, 0.233) 
Respiratory failure; insufficiency; arrest (adult)                                         & 0.674(0.715, 0.634) & 0.452 (0.513, 0.399) 
Septicemia (except in labor)                                                               & 0.637(0.686, 0.590) & 0.326 (0.396, 0.274) 
Shock                                                                                      & 0.642(0.688, 0.593) & 0.373 (0.448, 0.306) 



val  49  best mean auc :0.589 mean auprc 0.285 


                    CI AUROC (0.539, 0.640) CI AUPRC (0.242, 0.344) 


                     AUROC accute 0.599 mixed 0.587 chronic 0.571


                     AUROC accute CI (0.546, 0.654) mixed (0.537 , 0.637) chronic (0.528, 0.614)


                     AUPRC accute  0.264 mixed 0.267 chronic 0.339 


                     AUPRC accute CI  (0.220, 0.323) mixed (0.223,  0.328) chronic (0.294, 0.395) 


                    
